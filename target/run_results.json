{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-05-14T12:13:00.672916Z", "invocation_id": "0852eda4-bfe9-4a25-9e6c-fe095fb08f43", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:12:59.935716Z", "completed_at": "2025-05-14T12:12:59.943716Z"}, {"name": "execute", "started_at": "2025-05-14T12:12:59.944713Z", "completed_at": "2025-05-14T12:12:59.944713Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01100778579711914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.stg_raw_simulation__customer_product_mapping", "compiled": true, "compiled_code": "WITH columns_rename AS (\n    SELECT\n        \"id\" AS mapping_id,\n        \"cliente_id\" AS customer_id,\n        \"produto_id\" AS product_id\n\n    FROM RAW.RAW_SIMULATION.MAPEAMENTO_CLIENTE_PRODUTO\n\n)\n\nSELECT * FROM columns_rename", "relation_name": "RAW.RAW_SIMULATION.stg_raw_simulation__customer_product_mapping", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:12:59.945712Z", "completed_at": "2025-05-14T12:12:59.948712Z"}, {"name": "execute", "started_at": "2025-05-14T12:12:59.949713Z", "completed_at": "2025-05-14T12:12:59.949713Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004000425338745117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.stg_raw_simulation__customers", "compiled": true, "compiled_code": "WITH columns_rename AS (\n    SELECT\n\n        \"cliente_id\" AS customer_id,\n        \"nome\" AS customer_name,\n        \"email\" AS customer_email,\n        \"telefone\" AS customer_phone,\n        \"data_nascimento\" AS customer_date_of_birth,\n        \"vip\" AS customer_vip\n\n    FROM RAW.RAW_SIMULATION.CLIENTES\n\n),\n\nhandling_invalid_values AS (\n    SELECT\n        customer_id,\n        customer_name,\n        customer_date_of_birth,\n        customer_vip,\n        CASE\n            WHEN customer_email = 'emailinvalido.com' THEN 'INVALID_EMAIL'\n            ELSE customer_email\n        END AS customer_email,\n        CASE\n            WHEN trim(customer_phone) = '' THEN 'INVALID_PHONE'\n            ELSE customer_phone\n        END AS customer_phone\n\n    FROM columns_rename\n)\n\nSELECT * FROM handling_invalid_values", "relation_name": "RAW.RAW_SIMULATION.stg_raw_simulation__customers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:12:59.951712Z", "completed_at": "2025-05-14T12:12:59.954713Z"}, {"name": "execute", "started_at": "2025-05-14T12:12:59.954713Z", "completed_at": "2025-05-14T12:12:59.954713Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0040013790130615234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.stg_raw_simulation__exchange_rates", "compiled": true, "compiled_code": "WITH columns_renamed AS (\n    SELECT\n\n        original_total_value,\n        currency,\n        total_value_usd,\n        date_conversion\n\n    FROM RAW.RAW_SIMULATION.EXCHANGE_RATES\n\n)\n\nSELECT * FROM columns_renamed", "relation_name": "RAW.RAW_SIMULATION.stg_raw_simulation__exchange_rates", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:12:59.956712Z", "completed_at": "2025-05-14T12:12:59.959713Z"}, {"name": "execute", "started_at": "2025-05-14T12:12:59.959713Z", "completed_at": "2025-05-14T12:12:59.959713Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004000425338745117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.stg_raw_simulation__products", "compiled": true, "compiled_code": "WITH columns_rename AS (\n    SELECT\n        \"produto_id\" AS product_id,\n        \"nome\" AS product_name,\n        \"categoria\" AS product_category,\n        \"preco\" AS product_price\n\n    FROM RAW.RAW_SIMULATION.PRODUTOS\n\n),\n\ntransforming_invalid_values AS (\n    SELECT\n        product_id,\n        product_name,\n        ABS(product_price) AS product_price,\n        CASE\n            WHEN product_category = 'Roupaz' THEN 'Roupas'\n            WHEN product_category = 'roupas' THEN 'Roupas'\n            ELSE product_category\n        END AS product_category\n\n    FROM columns_rename\n)\n\nSELECT * FROM transforming_invalid_values", "relation_name": "RAW.RAW_SIMULATION.stg_raw_simulation__products", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:12:59.961828Z", "completed_at": "2025-05-14T12:12:59.963826Z"}, {"name": "execute", "started_at": "2025-05-14T12:12:59.964979Z", "completed_at": "2025-05-14T12:12:59.964979Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004266977310180664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.stg_raw_simulation__sales", "compiled": true, "compiled_code": "WITH columns_rename AS (\n    SELECT\n        venda_id AS sale_id,\n        data_venda AS sale_date,\n        cliente_id AS customer_id,\n        produto_id AS product_id,\n        loja_id AS store_id,\n        quantidade AS quantity_ordered,\n        preco_unitario AS product_unit_price,\n        valor_total AS sale_total_value,\n        moeda AS currency\n\n    FROM RAW.RAW_SIMULATION.VENDAS\n\n),\n\nadjusting_invalid_values AS (\n    SELECT\n\n        sale_id,\n        sale_date,\n        customer_id,\n        product_id,\n        store_id,\n        quantity_ordered,\n        currency,\n        ABS(product_unit_price) AS product_unit_price,\n        ABS(product_unit_price) * quantity_ordered AS sale_total_value\n\n    FROM columns_rename\n    WHERE quantity_ordered > 0\n)\n\nSELECT * FROM adjusting_invalid_values", "relation_name": "RAW.RAW_SIMULATION.stg_raw_simulation__sales", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:12:59.966984Z", "completed_at": "2025-05-14T12:12:59.969983Z"}, {"name": "execute", "started_at": "2025-05-14T12:12:59.969983Z", "completed_at": "2025-05-14T12:12:59.969983Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0039026737213134766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.stg_raw_simulation__stock", "compiled": true, "compiled_code": "WITH columns_rename AS (\n    SELECT\n        \"produto_id\" AS product_id,\n        \"loja_id\" AS store_id,\n        \"quantidade\" AS quantity_available\n\n    FROM RAW.RAW_SIMULATION.ESTOQUE\n\n)\n\nSELECT * FROM columns_rename", "relation_name": "RAW.RAW_SIMULATION.stg_raw_simulation__stock", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:12:59.971985Z", "completed_at": "2025-05-14T12:12:59.974984Z"}, {"name": "execute", "started_at": "2025-05-14T12:12:59.974984Z", "completed_at": "2025-05-14T12:12:59.974984Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003999233245849609, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.stg_raw_simulation__stores", "compiled": true, "compiled_code": "WITH columns_rename AS (\n    SELECT\n        \"loja_id\" AS store_id,\n        \"nome\" AS store_name,\n        \"cidade\" AS store_city,\n        \"estado\" AS state\n\n    FROM RAW.RAW_SIMULATION.LOJAS\n\n)\n\nSELECT * FROM columns_rename", "relation_name": "RAW.RAW_SIMULATION.stg_raw_simulation__stores", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:12:59.976985Z", "completed_at": "2025-05-14T12:12:59.985983Z"}, {"name": "execute", "started_at": "2025-05-14T12:12:59.986986Z", "completed_at": "2025-05-14T12:12:59.986986Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010997772216796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.accepted_values_stg_raw_simulation__customers_customer_vip__TRUE__FALSE.9a40660dbe", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_vip as value_field,\n        count(*) as n_records\n\n    from RAW.RAW_SIMULATION.stg_raw_simulation__customers\n    group by customer_vip\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'TRUE','FALSE'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:12:59.988985Z", "completed_at": "2025-05-14T12:12:59.995985Z"}, {"name": "execute", "started_at": "2025-05-14T12:12:59.995985Z", "completed_at": "2025-05-14T12:12:59.995985Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009000301361083984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_stg_raw_simulation__customers_customer_id.81c0f76866", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom RAW.RAW_SIMULATION.stg_raw_simulation__customers\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:12:59.997984Z", "completed_at": "2025-05-14T12:13:00.002087Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.002991Z", "completed_at": "2025-05-14T12:13:00.002991Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0050067901611328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_stg_raw_simulation__customers_customer_vip.78b1a7839f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_vip\nfrom RAW.RAW_SIMULATION.stg_raw_simulation__customers\nwhere customer_vip is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.004095Z", "completed_at": "2025-05-14T12:13:00.009985Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.009985Z", "completed_at": "2025-05-14T12:13:00.009985Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005889415740966797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.unique_stg_raw_simulation__customers_customer_id.c9e6075042", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom RAW.RAW_SIMULATION.stg_raw_simulation__customers\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.011991Z", "completed_at": "2025-05-14T12:13:00.017083Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.017985Z", "completed_at": "2025-05-14T12:13:00.017985Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0070002079010009766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_stg_raw_simulation__products_product_id.f95b58f68e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom RAW.RAW_SIMULATION.stg_raw_simulation__products\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.019985Z", "completed_at": "2025-05-14T12:13:00.023985Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.023985Z", "completed_at": "2025-05-14T12:13:00.023985Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0049517154693603516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_stg_raw_simulation__products_product_price.fc92677b9a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_price\nfrom RAW.RAW_SIMULATION.stg_raw_simulation__products\nwhere product_price is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.025985Z", "completed_at": "2025-05-14T12:13:00.030984Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.030984Z", "completed_at": "2025-05-14T12:13:00.030984Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005999565124511719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.unique_stg_raw_simulation__products_product_id.3717f09c91", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_id as unique_field,\n    count(*) as n_records\n\nfrom RAW.RAW_SIMULATION.stg_raw_simulation__products\nwhere product_id is not null\ngroup by product_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.032985Z", "completed_at": "2025-05-14T12:13:00.040985Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.040985Z", "completed_at": "2025-05-14T12:13:00.040985Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009999513626098633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.int__sales_with_exchange_rates", "compiled": true, "compiled_code": "\n\n\nWITH applying_exchange_rates AS (\n    SELECT\n\n        s.sale_id,\n        s.sale_date,\n        s.customer_id,\n        s.product_id,\n        s.store_id,\n        s.product_unit_price,\n        s.quantity_ordered,\n        s.currency,\n        ROUND(sale_total_value, 2) AS original_total_value,\n        CASE\n            WHEN s.currency = 'BRL' THEN ROUND(s.sale_total_value * 0.18, 2)\n            WHEN s.currency = 'MXN' THEN ROUND(s.sale_total_value * 0.05, 2)\n            WHEN s.currency = 'EUR' THEN ROUND(s.sale_total_value * 1.14, 2)\n            WHEN s.currency = 'USD' THEN s.sale_total_value\n        END AS total_value_usd,\n\n        CURRENT_DATE AS conversion_date\n\n    FROM RAW.RAW_SIMULATION.stg_raw_simulation__sales s\n    LEFT JOIN RAW.RAW_SIMULATION.stg_raw_simulation__exchange_rates e\n        ON s.currency = e.currency\n\n)\n\nSELECT *\nFROM applying_exchange_rates\n\n\n    WHERE sale_id NOT IN (SELECT sale_id FROM RAW.RAW_SIMULATION.int__sales_with_exchange_rates)\n", "relation_name": "RAW.RAW_SIMULATION.int__sales_with_exchange_rates", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.043984Z", "completed_at": "2025-05-14T12:13:00.048984Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.048984Z", "completed_at": "2025-05-14T12:13:00.048984Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005967855453491211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.accepted_values_stg_raw_simulation__sales_currency__BRL__USD__MXN__EUR.59d7c22155", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        currency as value_field,\n        count(*) as n_records\n\n    from RAW.RAW_SIMULATION.stg_raw_simulation__sales\n    group by currency\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'BRL','USD','MXN','EUR'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.050985Z", "completed_at": "2025-05-14T12:13:00.053984Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.054985Z", "completed_at": "2025-05-14T12:13:00.054985Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005000591278076172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_stg_raw_simulation__sales_currency.a1fea0633c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect currency\nfrom RAW.RAW_SIMULATION.stg_raw_simulation__sales\nwhere currency is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.055984Z", "completed_at": "2025-05-14T12:13:00.060983Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.061985Z", "completed_at": "2025-05-14T12:13:00.061985Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006000995635986328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_stg_raw_simulation__sales_customer_id.7bc3d7c514", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom RAW.RAW_SIMULATION.stg_raw_simulation__sales\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.062984Z", "completed_at": "2025-05-14T12:13:00.066983Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.067985Z", "completed_at": "2025-05-14T12:13:00.067985Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005000591278076172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_stg_raw_simulation__sales_sale_id.e2a1b8a690", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sale_id\nfrom RAW.RAW_SIMULATION.stg_raw_simulation__sales\nwhere sale_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.068984Z", "completed_at": "2025-05-14T12:13:00.072983Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.073984Z", "completed_at": "2025-05-14T12:13:00.073984Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004999876022338867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_stg_raw_simulation__sales_sale_total_value.1f1d790115", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sale_total_value\nfrom RAW.RAW_SIMULATION.stg_raw_simulation__sales\nwhere sale_total_value is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.074984Z", "completed_at": "2025-05-14T12:13:00.079009Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.079985Z", "completed_at": "2025-05-14T12:13:00.079985Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00500035285949707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.unique_stg_raw_simulation__sales_sale_id.7583375d16", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sale_id as unique_field,\n    count(*) as n_records\n\nfrom RAW.RAW_SIMULATION.stg_raw_simulation__sales\nwhere sale_id is not null\ngroup by sale_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.080983Z", "completed_at": "2025-05-14T12:13:00.083999Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.083999Z", "completed_at": "2025-05-14T12:13:00.083999Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0030159950256347656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.stock_health", "compiled": true, "compiled_code": "\n\nWITH stock AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.stg_raw_simulation__stock\n),\n\nstock_levels AS (\n\n    SELECT\n        product_id,\n        store_id,\n        quantity_available,\n        CASE\n            WHEN quantity_available = 0 THEN 'ZERO_STOCK'\n            WHEN quantity_available < 0 THEN 'NEGATIVE_STOCK'\n            ELSE 'OK'\n        END AS stock_status\n\n    FROM stock\n)\n\nSELECT * FROM stock_levels", "relation_name": "RAW.RAW_SIMULATION.stock_health", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.085982Z", "completed_at": "2025-05-14T12:13:00.091998Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.092984Z", "completed_at": "2025-05-14T12:13:00.092984Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00800013542175293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.relationships_stg_raw_simulation__stock_product_id__product_id__ref_stg_raw_simulation__products_.f3cf3dc923", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_id as from_field\n    from RAW.RAW_SIMULATION.stg_raw_simulation__stock\n    where product_id is not null\n),\n\nparent as (\n    select product_id as to_field\n    from RAW.RAW_SIMULATION.stg_raw_simulation__products\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.094105Z", "completed_at": "2025-05-14T12:13:00.098110Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.098110Z", "completed_at": "2025-05-14T12:13:00.098110Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00400543212890625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_stg_raw_simulation__stores_store_id.b79d027d4d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect store_id\nfrom RAW.RAW_SIMULATION.stg_raw_simulation__stores\nwhere store_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.100111Z", "completed_at": "2025-05-14T12:13:00.105110Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.106110Z", "completed_at": "2025-05-14T12:13:00.106110Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0069997310638427734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.relationships_stg_raw_simulation__stock_store_id__store_id__ref_stg_raw_simulation__stores_.af63dc69f6", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select store_id as from_field\n    from RAW.RAW_SIMULATION.stg_raw_simulation__stock\n    where store_id is not null\n),\n\nparent as (\n    select store_id as to_field\n    from RAW.RAW_SIMULATION.stg_raw_simulation__stores\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.107111Z", "completed_at": "2025-05-14T12:13:00.111112Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.111112Z", "completed_at": "2025-05-14T12:13:00.111112Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0050013065338134766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.unique_stg_raw_simulation__stores_store_id.fcdc1cff5e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    store_id as unique_field,\n    count(*) as n_records\n\nfrom RAW.RAW_SIMULATION.stg_raw_simulation__stores\nwhere store_id is not null\ngroup by store_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.113111Z", "completed_at": "2025-05-14T12:13:00.116110Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.116110Z", "completed_at": "2025-05-14T12:13:00.116110Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003999948501586914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.dm__exchange_rates", "compiled": true, "compiled_code": "WITH exchange_rates AS (\n\n    SELECT *\n    FROM RAW.RAW_SIMULATION.int__sales_with_exchange_rates\n\n),\n\nexchange_rates_separation AS (\n\n    SELECT\n\n        currency AS of_currency,\n\n        'USD' AS to_currency,\n\n        ROUND(original_total_value / total_value_usd, 2) AS exchange_rate_used,\n\n        CURRENT_DATE AS exchange_rate_date\n\n    FROM exchange_rates\n\n)\n\nSELECT * FROM exchange_rates_separation", "relation_name": "RAW.RAW_SIMULATION.dm__exchange_rates", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.118138Z", "completed_at": "2025-05-14T12:13:00.120125Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.121110Z", "completed_at": "2025-05-14T12:13:00.121110Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003957986831665039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.fct_sales__finance_metrics_usd", "compiled": true, "compiled_code": "WITH sales AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.int__sales_with_exchange_rates\n),\n\nsales_with_metrics_usd AS (\n    SELECT\n        sale_id,\n        sale_date,\n        customer_id,\n        product_id,\n        store_id,\n        product_unit_price,\n        quantity_ordered,\n        'USD' AS currency,\n        total_value_usd AS total_value,\n        conversion_date\n\n    FROM sales\n)\n\nSELECT * FROM sales_with_metrics_usd", "relation_name": "RAW.RAW_SIMULATION.fct_sales__finance_metrics_usd", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.124111Z", "completed_at": "2025-05-14T12:13:00.128109Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.128109Z", "completed_at": "2025-05-14T12:13:00.128109Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008002281188964844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.int__customers_metrics", "compiled": true, "compiled_code": "\n\n\nWITH source AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.stg_raw_simulation__customers\n\n),\n\nmetrics AS (\n    SELECT\n        c.customer_id,\n        c.customer_name,\n        c.customer_vip,\n        COUNT(s.sale_id) AS total_customer_orders,\n        SUM(s.total_value_usd) AS total_spend,\n        MIN(s.sale_date) AS first_purchase,\n        MAX(s.sale_date) AS last_purchase\n    FROM source c\n    LEFT JOIN RAW.RAW_SIMULATION.int__sales_with_exchange_rates s ON c.customer_id = s.customer_id AND sale_date IS NOT NULL\n    GROUP BY c.customer_id, c.customer_name, c.customer_vip\n)\n\nSELECT * FROM metrics\n\n\n\n    WHERE last_purchase > (\n        SELECT MAX(last_purchase)\n        FROM RAW.RAW_SIMULATION.int__customers_metrics\n        WHERE customer_id = metrics.customer_id\n    )\n", "relation_name": "RAW.RAW_SIMULATION.int__customers_metrics", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.130110Z", "completed_at": "2025-05-14T12:13:00.134112Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.134112Z", "completed_at": "2025-05-14T12:13:00.134112Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0050008296966552734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.int__products_metrics", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.stg_raw_simulation__products\n\n),\n\nmetrics AS (\n\n    SELECT\n        p.product_id,\n        p.product_name,\n        p.product_price,\n        p.product_category,\n        COUNT(s.quantity_ordered) AS total_unit_sold,\n        SUM(total_value_usd) AS total_revenue_usd,\n        ROUND(total_revenue_usd / total_unit_sold, 2) AS average_sale_value_usd,\n        MIN(s.sale_date) AS first_sale_product,\n        MAX(s.sale_date) AS last_sale_product\n\n    FROM source p\n    LEFT JOIN RAW.RAW_SIMULATION.int__sales_with_exchange_rates s ON p.product_id = s.product_id\n    GROUP BY\n        p.product_id,\n        p.product_name,\n        p.product_price,\n        p.product_category\n\n)\n\nSELECT * FROM metrics\n\n\n\n    WHERE last_sale_product > (\n        SELECT MAX(last_sale_product)\n        FROM RAW.RAW_SIMULATION.int__products_metrics\n        WHERE product_id = metrics.product_id\n    )\n", "relation_name": "RAW.RAW_SIMULATION.int__products_metrics", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.136127Z", "completed_at": "2025-05-14T12:13:00.140315Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.140315Z", "completed_at": "2025-05-14T12:13:00.140315Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005188703536987305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.int__stores_metrics", "compiled": true, "compiled_code": "\n\n\nWITH source AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.stg_raw_simulation__stores\n),\n\nmetrics AS (\n\n    SELECT\n        s.store_id,\n        s.store_name,\n        s.store_city,\n        s.state,\n        COUNT(e.sale_id) AS total_sales_store,\n        SUM(e.total_value_usd) AS total_revenue_store_usd,\n        ROUND(total_revenue_store_usd / total_sales_store, 2) AS average_sale_value_usd,\n        MIN(e.sale_date) AS first_sale,\n        MAX(e.sale_date) AS last_sale\n\n    FROM source s\n    LEFT JOIN RAW.RAW_SIMULATION.int__sales_with_exchange_rates e ON s.store_id = e.store_id\n    GROUP BY\n        s.store_id,\n        s.store_name,\n        s.store_city,\n        s.state\n)\n\nSELECT * FROM metrics\n\n\n\n    WHERE last_sale > (\n        SELECT MAX(last_sale)\n        FROM RAW.RAW_SIMULATION.int__stores_metrics\n        WHERE store_id = metrics.store_id\n    )\n", "relation_name": "RAW.RAW_SIMULATION.int__stores_metrics", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.142320Z", "completed_at": "2025-05-14T12:13:00.144320Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.145320Z", "completed_at": "2025-05-14T12:13:00.145320Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003999471664428711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.sales_by_currency", "compiled": true, "compiled_code": "\n\nWITH sales AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.int__sales_with_exchange_rates\n),\n\ntotal_values_by_currency AS (\n    SELECT\n\n        currency,\n        ROUND(SUM(original_total_value)) AS total_sold_by_currency\n\n    FROM sales\n    GROUP BY currency\n),\n\nsale_total_value AS (\n    SELECT\n\n        SUM(total_sold_by_currency) AS value_total\n\n    FROM total_values_by_currency\n),\n\nsales_by_currency AS (\n    SELECT\n\n        tvc.currency,\n        tvc.total_sold_by_currency,\n        ROUND(tvc.total_sold_by_currency * 100 / stv.value_total, 2) || '%' AS percentage_of_foreign_exchange_exposure\n\n    FROM sale_total_value stv\n    INNER JOIN total_values_by_currency tvc\n)\n\nSELECT * FROM sales_by_currency\nORDER BY percentage_of_foreign_exchange_exposure DESC", "relation_name": "RAW.RAW_SIMULATION.sales_by_currency", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.146320Z", "completed_at": "2025-05-14T12:13:00.150319Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.150319Z", "completed_at": "2025-05-14T12:13:00.150319Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005001068115234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.accepted_values_int__sales_with_exchange_rates_currency__BRL__USD__MXN__EUR.9e32425f90", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        currency as value_field,\n        count(*) as n_records\n\n    from RAW.RAW_SIMULATION.int__sales_with_exchange_rates\n    group by currency\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'BRL','USD','MXN','EUR'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.152320Z", "completed_at": "2025-05-14T12:13:00.156320Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.156320Z", "completed_at": "2025-05-14T12:13:00.156320Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004999399185180664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_int__sales_with_exchange_rates_currency.97a6828700", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect currency\nfrom RAW.RAW_SIMULATION.int__sales_with_exchange_rates\nwhere currency is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.158320Z", "completed_at": "2025-05-14T12:13:00.161320Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.161320Z", "completed_at": "2025-05-14T12:13:00.161320Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005000591278076172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_int__sales_with_exchange_rates_original_total_value.ccca33ea0b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect original_total_value\nfrom RAW.RAW_SIMULATION.int__sales_with_exchange_rates\nwhere original_total_value is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.163320Z", "completed_at": "2025-05-14T12:13:00.166320Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.167321Z", "completed_at": "2025-05-14T12:13:00.167321Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005000114440917969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_int__sales_with_exchange_rates_sale_id.620f7481c4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sale_id\nfrom RAW.RAW_SIMULATION.int__sales_with_exchange_rates\nwhere sale_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.169320Z", "completed_at": "2025-05-14T12:13:00.172319Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.173321Z", "completed_at": "2025-05-14T12:13:00.173321Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004999637603759766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_int__sales_with_exchange_rates_total_value_usd.69290a3117", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_value_usd\nfrom RAW.RAW_SIMULATION.int__sales_with_exchange_rates\nwhere total_value_usd is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.174319Z", "completed_at": "2025-05-14T12:13:00.179321Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.179321Z", "completed_at": "2025-05-14T12:13:00.179321Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005001544952392578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.unique_int__sales_with_exchange_rates_sale_id.9f31db78bc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sale_id as unique_field,\n    count(*) as n_records\n\nfrom RAW.RAW_SIMULATION.int__sales_with_exchange_rates\nwhere sale_id is not null\ngroup by sale_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.181321Z", "completed_at": "2025-05-14T12:13:00.186320Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.186320Z", "completed_at": "2025-05-14T12:13:00.186320Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006000041961669922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.accepted_values_stock_health_stock_status__OK__ZERO_STOCK__NEGATIVE_STOCK.fc8a5b3e8f", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        stock_status as value_field,\n        count(*) as n_records\n\n    from RAW.RAW_SIMULATION.stock_health\n    group by stock_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'OK','ZERO_STOCK','NEGATIVE_STOCK'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.188321Z", "completed_at": "2025-05-14T12:13:00.192150Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.192150Z", "completed_at": "2025-05-14T12:13:00.192150Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00482940673828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_stock_health_product_id.00b3b4b68c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom RAW.RAW_SIMULATION.stock_health\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.194154Z", "completed_at": "2025-05-14T12:13:00.197155Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.198155Z", "completed_at": "2025-05-14T12:13:00.198155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00500035285949707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_stock_health_store_id.5d5bbecc01", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect store_id\nfrom RAW.RAW_SIMULATION.stock_health\nwhere store_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.199154Z", "completed_at": "2025-05-14T12:13:00.202154Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.202154Z", "completed_at": "2025-05-14T12:13:00.202154Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004999637603759766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.sales_by_category_and_period", "compiled": true, "compiled_code": "\n\nsales AS (\n\n    SELECT *\n    FROM RAW.RAW_SIMULATION.fct_sales__finance_metrics_usd\n),\n\n\nstrategic_analysis as (\n    SELECT\n        p.product_category,\n        DATE_TRUNC('month', s.sale_date) as month,\n        CASE\n            WHEN EXTRACT(MONTH FROM s.sale_date) IN (12,1,2) THEN 'SUMMER'\n            WHEN EXTRACT(MONTH FROM s.sale_date) IN (3,4,5) THEN 'FALL'\n            WHEN EXTRACT(MONTH FROM s.sale_date) IN (6,7,8) THEN 'WINTER'\n            WHEN EXTRACT(MONTH FROM s.sale_date) IN (9,10,11) THEN 'SPRING'\n            ELSE NULL\n        END as station,\n\n        SUM(ROUND(s.total_value)) as total_revenue_by_month,\n        COUNT(s.sale_id) as total_sales_by_month\n\n\n    FROM sales s\n    JOIN products p ON s.product_id = p.product_id\n    GROUP BY p.product_category, DATE_TRUNC('month', s.sale_date), station\n)\n\nSELECT * FROM strategic_analysis", "relation_name": "RAW.RAW_SIMULATION.sales_by_category_and_period", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.204155Z", "completed_at": "2025-05-14T12:13:00.207155Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.207155Z", "completed_at": "2025-05-14T12:13:00.207155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0039997100830078125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.sales_per_day_and_average_ticket", "compiled": true, "compiled_code": "\n\nWITH sales AS (\n\n    SELECT *\n    FROM RAW.RAW_SIMULATION.fct_sales__finance_metrics_usd\n),\n\nsales_by_day AS (\n    SELECT\n        DATE_TRUNC('day', sale_date) AS sale_date,\n        COUNT(DISTINCT sale_id) AS sales_by_day,\n        ROUND(AVG(total_value)) AS average_ticket\n    FROM sales\n    GROUP BY sale_date\n)\n\nSELECT * FROM sales_by_day\nORDER BY sale_date", "relation_name": "RAW.RAW_SIMULATION.sales_per_day_and_average_ticket", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.209155Z", "completed_at": "2025-05-14T12:13:00.212155Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.212155Z", "completed_at": "2025-05-14T12:13:00.213155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00500035285949707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.accepted_values_fct_sales__finance_metrics_usd_currency__USD.dc2ecb42f7", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        currency as value_field,\n        count(*) as n_records\n\n    from RAW.RAW_SIMULATION.fct_sales__finance_metrics_usd\n    group by currency\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'USD'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.214155Z", "completed_at": "2025-05-14T12:13:00.218155Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.219155Z", "completed_at": "2025-05-14T12:13:00.219155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0060002803802490234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_fct_sales__finance_metrics_usd_currency.cb26c6ad68", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect currency\nfrom RAW.RAW_SIMULATION.fct_sales__finance_metrics_usd\nwhere currency is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.220155Z", "completed_at": "2025-05-14T12:13:00.224154Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.224154Z", "completed_at": "2025-05-14T12:13:00.224154Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003999471664428711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_fct_sales__finance_metrics_usd_sale_id.12c2bc8627", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sale_id\nfrom RAW.RAW_SIMULATION.fct_sales__finance_metrics_usd\nwhere sale_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.226155Z", "completed_at": "2025-05-14T12:13:00.229154Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.230155Z", "completed_at": "2025-05-14T12:13:00.230155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004999876022338867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_fct_sales__finance_metrics_usd_total_value.88c9938e49", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_value\nfrom RAW.RAW_SIMULATION.fct_sales__finance_metrics_usd\nwhere total_value is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.232154Z", "completed_at": "2025-05-14T12:13:00.235155Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.236155Z", "completed_at": "2025-05-14T12:13:00.236155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005000114440917969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.unique_fct_sales__finance_metrics_usd_sale_id.9f23004c8b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sale_id as unique_field,\n    count(*) as n_records\n\nfrom RAW.RAW_SIMULATION.fct_sales__finance_metrics_usd\nwhere sale_id is not null\ngroup by sale_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.237155Z", "completed_at": "2025-05-14T12:13:00.240155Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.240155Z", "completed_at": "2025-05-14T12:13:00.240155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003000497817993164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.dm__customers_metrics", "compiled": true, "compiled_code": "WITH customers AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.int__customers_metrics\n),\n\ncustomers_metrics_joined AS (\n    SELECT\n\n        customer_id,\n        customer_name,\n        customer_vip,\n        total_customer_orders,\n        total_spend,\n        first_purchase,\n        last_purchase\n\n    FROM customers\n)\n\nSELECT * FROM customers_metrics_joined", "relation_name": "RAW.RAW_SIMULATION.dm__customers_metrics", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.242154Z", "completed_at": "2025-05-14T12:13:00.246154Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.246154Z", "completed_at": "2025-05-14T12:13:00.246154Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004999637603759766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.accepted_values_int__customers_metrics_customer_vip__TRUE__FALSE.ba7f710b23", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_vip as value_field,\n        count(*) as n_records\n\n    from RAW.RAW_SIMULATION.int__customers_metrics\n    group by customer_vip\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'TRUE','FALSE'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.248155Z", "completed_at": "2025-05-14T12:13:00.252154Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.252154Z", "completed_at": "2025-05-14T12:13:00.252154Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0049991607666015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_int__customers_metrics_customer_id.d7c4f4c7a2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom RAW.RAW_SIMULATION.int__customers_metrics\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.254154Z", "completed_at": "2025-05-14T12:13:00.257155Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.258156Z", "completed_at": "2025-05-14T12:13:00.258156Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00500035285949707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.unique_int__customers_metrics_customer_id.9767483c35", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom RAW.RAW_SIMULATION.int__customers_metrics\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.259154Z", "completed_at": "2025-05-14T12:13:00.262156Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.262156Z", "completed_at": "2025-05-14T12:13:00.262156Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0030012130737304688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.dm__products_metrics", "compiled": true, "compiled_code": "WITH products AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.int__products_metrics\n),\n\nproducts_metrics_joined AS (\n    SELECT\n\n        product_id,\n        product_name,\n        product_price,\n        product_category,\n        total_unit_sold,\n        total_revenue_usd,\n        average_sale_value_usd,\n        first_sale_product,\n        last_sale_product\n\n    FROM products\n)\n\nSELECT * FROM products_metrics_joined", "relation_name": "RAW.RAW_SIMULATION.dm__products_metrics", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.264156Z", "completed_at": "2025-05-14T12:13:00.268157Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.268157Z", "completed_at": "2025-05-14T12:13:00.268157Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005001544952392578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_int__products_metrics_product_id.e5c183a8e0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom RAW.RAW_SIMULATION.int__products_metrics\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.270155Z", "completed_at": "2025-05-14T12:13:00.274155Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.274155Z", "completed_at": "2025-05-14T12:13:00.274155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005000591278076172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.unique_int__products_metrics_product_id.511da6ff24", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_id as unique_field,\n    count(*) as n_records\n\nfrom RAW.RAW_SIMULATION.int__products_metrics\nwhere product_id is not null\ngroup by product_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.275155Z", "completed_at": "2025-05-14T12:13:00.278154Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.279155Z", "completed_at": "2025-05-14T12:13:00.279155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004001140594482422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.dm__stores_metrics", "compiled": true, "compiled_code": "WITH stores AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.int__stores_metrics\n),\n\nstores_metrics_joined AS (\n\n    SELECT\n\n        store_id,\n        store_name,\n        store_city,\n        state,\n        total_sales_store,\n        total_revenue_store_usd,\n        average_sale_value_usd,\n        first_sale,\n        last_sale\n\n    FROM stores\n)\n\nSELECT * FROM stores_metrics_joined", "relation_name": "RAW.RAW_SIMULATION.dm__stores_metrics", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.280154Z", "completed_at": "2025-05-14T12:13:00.284155Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.284155Z", "completed_at": "2025-05-14T12:13:00.284155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004000186920166016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.geographical_distribution", "compiled": true, "compiled_code": "\n\nWITH stores AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.int__stores_metrics\n),\n\nsales AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.fct_sales__finance_metrics_usd\n),\n\nstore_sales_by_state_and_city AS (\n    SELECT\n        st.store_city,\n        st.state,\n        COUNT(s.sale_id) AS total_sales,\n        ROUND(SUM(s.total_value)) AS revenue_generated\n\n    FROM stores st\n    LEFT JOIN sales s ON st.store_id = s.store_id\n    GROUP BY st.store_city, st.state\n)\n\nSELECT * FROM store_sales_by_state_and_city", "relation_name": "RAW.RAW_SIMULATION.geographical_distribution", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.285155Z", "completed_at": "2025-05-14T12:13:00.290154Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.290154Z", "completed_at": "2025-05-14T12:13:00.290154Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004999399185180664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.accepted_values_sales_by_currency_currency__BRL__USD__MXN__EUR.19283669ff", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        currency as value_field,\n        count(*) as n_records\n\n    from RAW.RAW_SIMULATION.sales_by_currency\n    group by currency\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'BRL','USD','MXN','EUR'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.292154Z", "completed_at": "2025-05-14T12:13:00.295154Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.296156Z", "completed_at": "2025-05-14T12:13:00.296156Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00500178337097168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_sales_by_currency_currency.25cb5876f6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect currency\nfrom RAW.RAW_SIMULATION.sales_by_currency\nwhere currency is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.297154Z", "completed_at": "2025-05-14T12:13:00.301154Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.301154Z", "completed_at": "2025-05-14T12:13:00.301154Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004000186920166016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.unique_sales_by_currency_currency.f83ca932dd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    currency as unique_field,\n    count(*) as n_records\n\nfrom RAW.RAW_SIMULATION.sales_by_currency\nwhere currency is not null\ngroup by currency\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.302154Z", "completed_at": "2025-05-14T12:13:00.306155Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.306155Z", "completed_at": "2025-05-14T12:13:00.306155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004000186920166016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_sales_per_day_and_average_ticket_sale_date.44388f8da9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sale_date\nfrom RAW.RAW_SIMULATION.sales_per_day_and_average_ticket\nwhere sale_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.308155Z", "completed_at": "2025-05-14T12:13:00.312169Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.312169Z", "completed_at": "2025-05-14T12:13:00.312169Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0050144195556640625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_sales_per_day_and_average_ticket_sales_by_day.baebe44b6f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sales_by_day\nfrom RAW.RAW_SIMULATION.sales_per_day_and_average_ticket\nwhere sales_by_day is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.314155Z", "completed_at": "2025-05-14T12:13:00.317155Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.317155Z", "completed_at": "2025-05-14T12:13:00.317155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004001140594482422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.customer_ltv", "compiled": true, "compiled_code": "\n\nWITH customers AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.dm__customers_metrics\n),\n\nltv AS (\n    SELECT\n        customer_id,\n        customer_name,\n        total_spend AS customer_ltv\n    FROM customers\n)\n\nSELECT * FROM ltv", "relation_name": "RAW.RAW_SIMULATION.customer_ltv", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.319154Z", "completed_at": "2025-05-14T12:13:00.322154Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.322154Z", "completed_at": "2025-05-14T12:13:00.322154Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0039975643157958984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.customer_repeat_rate", "compiled": true, "compiled_code": "\n\n\nWITH customers AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.dm__customers_metrics\n),\n\npercentage_of_repeat_customer_purchase AS (\n    SELECT\n\n        round(\n            count_if(total_customer_orders > 1) * 1.0 / count(*) * 100,\n            2\n        ) AS repeat_customer_rate_percentage\n\n    FROM customers\n)\n\nSELECT * FROM percentage_of_repeat_customer_purchase", "relation_name": "RAW.RAW_SIMULATION.customer_repeat_rate", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.324154Z", "completed_at": "2025-05-14T12:13:00.328154Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.328154Z", "completed_at": "2025-05-14T12:13:00.328154Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004999876022338867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.most_common_product_bundles", "compiled": true, "compiled_code": "\n\nWITH sales AS (\n\n    SELECT *\n    FROM RAW.RAW_SIMULATION.fct_sales__finance_metrics_usd\n),\n\ncustomers AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.dm__customers_metrics\n),\n\ntop_products_per_customer AS (\n    SELECT\n        c.customer_id,\n        c.customer_name,\n        s.product_id,\n        ROW_NUMBER() OVER (\n            PARTITION BY c.customer_id\n            ORDER BY COUNT(*) DESC\n        ) AS rank_products_purchased\n\n    FROM customers c\n    LEFT JOIN sales s ON c.customer_id = s.customer_id\n    GROUP BY c.customer_id, c.customer_name, s.product_id\n    QUALIFY rank_products_purchased <= 2\n),\n\nproduct_pairs AS (\n    SELECT\n        a.customer_id,\n        a.customer_name,\n        LEAST(a.product_id, b.product_id) AS product_1,\n        GREATEST(a.product_id, b.product_id) AS product_2\n    FROM top_products_per_customer a\n    INNER JOIN top_products_per_customer b\n    ON a.customer_id = b.customer_id AND a.product_id <> b.product_id\n    WHERE a.product_id < b.product_id\n)\n\nSELECT DISTINCT *\nFROM product_pairs", "relation_name": "RAW.RAW_SIMULATION.most_common_product_bundles", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.330154Z", "completed_at": "2025-05-14T12:13:00.333154Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.334155Z", "completed_at": "2025-05-14T12:13:00.334155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004999637603759766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.accepted_values_dm__customers_metrics_customer_vip__TRUE__FALSE.65712c2a1a", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_vip as value_field,\n        count(*) as n_records\n\n    from RAW.RAW_SIMULATION.dm__customers_metrics\n    group by customer_vip\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'TRUE','FALSE'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.335154Z", "completed_at": "2025-05-14T12:13:00.339155Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.340155Z", "completed_at": "2025-05-14T12:13:00.340155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005001068115234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_dm__customers_metrics_customer_id.903c60a556", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom RAW.RAW_SIMULATION.dm__customers_metrics\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.342153Z", "completed_at": "2025-05-14T12:13:00.345168Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.346154Z", "completed_at": "2025-05-14T12:13:00.346154Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004997730255126953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_dm__customers_metrics_customer_vip.a3707571d2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_vip\nfrom RAW.RAW_SIMULATION.dm__customers_metrics\nwhere customer_vip is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.347154Z", "completed_at": "2025-05-14T12:13:00.351169Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.351169Z", "completed_at": "2025-05-14T12:13:00.351169Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005001068115234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_dm__customers_metrics_total_customers_orders.43f1c24fc9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_customers_orders\nfrom RAW.RAW_SIMULATION.dm__customers_metrics\nwhere total_customers_orders is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.353154Z", "completed_at": "2025-05-14T12:13:00.357175Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.357175Z", "completed_at": "2025-05-14T12:13:00.357175Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005019426345825195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.unique_dm__customers_metrics_customer_id.1a1a8b245c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom RAW.RAW_SIMULATION.dm__customers_metrics\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.359153Z", "completed_at": "2025-05-14T12:13:00.363157Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.363157Z", "completed_at": "2025-05-14T12:13:00.363157Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005002498626708984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.best_selling_products_by_category", "compiled": true, "compiled_code": "\n\nWITH products AS (\n\n    SELECT *\n    FROM RAW.RAW_SIMULATION.dm__products_metrics\n),\n\nbest_selling_products_by_category_revenue AS (\n\n    SELECT\n\n        p.product_id,\n        p.product_name,\n        p.product_category,\n        p.total_revenue_usd,\n\n        RANK() OVER (\n            PARTITION BY p.product_category\n            ORDER BY ROUND(p.total_revenue_usd, 2) DESC\n        ) AS rank_products\n\n    FROM products p\n    QUALIFY rank_products <= 5\n),\n\nbest_selling_products_by_category_orders AS (\n\n    SELECT\n\n        p.product_id,\n        p.product_name,\n        p.product_category,\n        p.total_unit_sold,\n\n        RANK() OVER (\n            PARTITION BY p.product_category\n            ORDER BY p.total_sales_count DESC\n        ) AS rank_products\n\n    FROM products p\n    QUALIFY rank_products <= 5\n)\n\nSELECT\n\n    product_id,\n    product_name,\n    product_category,\n    ROUND(total_revenue_usd) AS total_revenue_and_orders,\n    rank_products,\n    'REVENUE' AS ranking_type\n\nFROM best_selling_products_by_category_revenue\n\nUNION ALL\n\nSELECT\n\n    product_id,\n    product_name,\n    product_category,\n    total_sales_count AS total_sales,\n    rank_products,\n    'ORDERS' AS ranking_type\n\nFROM best_selling_products_by_category_orders", "relation_name": "RAW.RAW_SIMULATION.best_selling_products_by_category", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.365158Z", "completed_at": "2025-05-14T12:13:00.410156Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.410156Z", "completed_at": "2025-05-14T12:13:00.410156Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04597735404968262, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.product_performance_over_time", "compiled": true, "compiled_code": "\n\nWITH products AS (\n\n    SELECT *\n    FROM RAW.RAW_SIMULATION.dm__products_metrics\n),\n\nsales AS (\n\n    SELECT *\n    FROM RAW.RAW_SIMULATION.fct_sales__finance_metrics_usd\n),\n\nrevenue_and_unit_month AS (\n    SELECT\n        p.product_id,\n        p.product_name,\n        DATE_TRUNC('month', s.sale_date) AS month,\n        SUM(s.quantity_ordered) AS total_unit_per_month,\n        ROUND(SUM(s.total_value)) AS revenue_generated_per_month\n\n    FROM products p\n    LEFT JOIN sales s ON p.product_id = s.product_id\n    GROUP BY p.product_id, p.product_name, month\n\n),\n\nrevenue_and_unit_week AS (\n    SELECT\n        p.product_id,\n        p.product_name,\n        DATE_TRUNC('week', s.sale_date) AS week,\n        SUM(s.quantity_ordered) AS total_unit_per_week,\n        ROUND(SUM(s.total_value)) AS revenue_generated_per_week\n\n    FROM products p\n    LEFT JOIN sales s ON p.product_id = s.product_id\n    GROUP BY p.product_id, p.product_name, week\n\n)\n\nSELECT\n    product_id,\n    product_name,\n    month AS date,\n    total_unit_per_month AS total_unit_sold,\n    revenue_generated_per_month AS total_revenue_generated,\n    'MONTH' AS period_type\nFROM revenue_and_unit_month\n\nUNION ALL\n\nSELECT\n    product_id,\n    product_name,\n    week AS date,\n    total_unit_per_week AS total_unit_sold,\n    revenue_generated_per_week AS total_revenue_generated,\n    'WEEK' AS period_type\nFROM revenue_and_unit_week\n\nORDER BY date, product_id", "relation_name": "RAW.RAW_SIMULATION.product_performance_over_time", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.412155Z", "completed_at": "2025-05-14T12:13:00.415154Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.416156Z", "completed_at": "2025-05-14T12:13:00.416156Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005000591278076172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.vip_or_non_vip_customer_behavior", "compiled": true, "compiled_code": "\n\n\nWITH customers AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.dm__customers_metrics\n),\n\nproducts AS (\n\n    SELECT *\n    FROM RAW.RAW_SIMULATION.dm__products_metrics\n),\n\nsales AS (\n\n    SELECT *\n    FROM RAW.RAW_SIMULATION.fct_sales__finance_metrics_usd\n),\n\nbase AS (\n    SELECT\n        c.customer_id,\n        c.total_spend,\n        c.total_customer_orders,\n        c.customer_vip,\n        p.product_category\n\n    FROM customers c\n    LEFT JOIN sales s ON c.customer_id = s.customer_id\n    LEFT JOIN products p ON s.product_id = p.product_id\n),\n\nmost_purchased_category AS (\n    SELECT\n        customer_vip,\n        product_category,\n        COUNT(*) AS category_purchase\n\n    FROM base\n    GROUP BY customer_vip, product_category\n),\n\nranked_categories AS (\n    SELECT\n        *,\n        RANK() OVER (\n            PARTITION BY customer_vip\n            ORDER BY product_category\n        ) AS rank_categories\n\n    FROM most_purchased_category\n    QUALIFY rank_categories = 1\n),\n\nbehavior_vip_or_non_vip AS (\n    SELECT\n\n        c.customer_vip,\n\n        ROUND(SUM(c.total_spend) / SUM(c.total_customer_orders)) AS average_ticket,\n        ROUND(AVG(c.total_customer_orders)) AS frequency\n\n    FROM customers c\n    GROUP BY c.customer_vip\n)\n\nSELECT\n    b.customer_vip,\n    b.average_ticket,\n    b.frequency,\n    rk.product_category AS most_purchased_category\nFROM behavior_vip_or_non_vip b\nLEFT JOIN ranked_categories rk ON b.customer_vip = rk.customer_vip", "relation_name": "RAW.RAW_SIMULATION.vip_or_non_vip_customer_behavior", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.417160Z", "completed_at": "2025-05-14T12:13:00.421154Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.422154Z", "completed_at": "2025-05-14T12:13:00.422154Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0049932003021240234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_dm__products_metrics_product_id.ae17f5d249", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom RAW.RAW_SIMULATION.dm__products_metrics\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.423192Z", "completed_at": "2025-05-14T12:13:00.427155Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.427155Z", "completed_at": "2025-05-14T12:13:00.427155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0039632320404052734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_dm__products_metrics_total_revenue_usd.45efa52503", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_revenue_usd\nfrom RAW.RAW_SIMULATION.dm__products_metrics\nwhere total_revenue_usd is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.429155Z", "completed_at": "2025-05-14T12:13:00.432153Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.433155Z", "completed_at": "2025-05-14T12:13:00.433155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004999399185180664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_dm__products_metrics_total_sales_count.ad1ad009b2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_sales_count\nfrom RAW.RAW_SIMULATION.dm__products_metrics\nwhere total_sales_count is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.434155Z", "completed_at": "2025-05-14T12:13:00.438155Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.438155Z", "completed_at": "2025-05-14T12:13:00.438155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004999637603759766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.unique_dm__products_metrics_product_id.19f673e7bb", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_id as unique_field,\n    count(*) as n_records\n\nfrom RAW.RAW_SIMULATION.dm__products_metrics\nwhere product_id is not null\ngroup by product_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.439154Z", "completed_at": "2025-05-14T12:13:00.444155Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.444155Z", "completed_at": "2025-05-14T12:13:00.444155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005000591278076172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_dm__stores_metrics_store_id.2b2f54209a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect store_id\nfrom RAW.RAW_SIMULATION.dm__stores_metrics\nwhere store_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.445155Z", "completed_at": "2025-05-14T12:13:00.449154Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.450155Z", "completed_at": "2025-05-14T12:13:00.450155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005000114440917969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_dm__stores_metrics_total_revenue_store.a326cf7605", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_revenue_store\nfrom RAW.RAW_SIMULATION.dm__stores_metrics\nwhere total_revenue_store is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.451156Z", "completed_at": "2025-05-14T12:13:00.455155Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.455155Z", "completed_at": "2025-05-14T12:13:00.455155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003998756408691406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_dm__stores_metrics_total_sales_store.0429e8302d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_sales_store\nfrom RAW.RAW_SIMULATION.dm__stores_metrics\nwhere total_sales_store is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.457154Z", "completed_at": "2025-05-14T12:13:00.460155Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.461154Z", "completed_at": "2025-05-14T12:13:00.461154Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004999637603759766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.unique_dm__stores_metrics_store_id.be738311d4", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    store_id as unique_field,\n    count(*) as n_records\n\nfrom RAW.RAW_SIMULATION.dm__stores_metrics\nwhere store_id is not null\ngroup by store_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.462155Z", "completed_at": "2025-05-14T12:13:00.466154Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.466154Z", "completed_at": "2025-05-14T12:13:00.466154Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003999471664428711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_geographical_distribution_state.deb2b2e308", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state\nfrom RAW.RAW_SIMULATION.geographical_distribution\nwhere state is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.468154Z", "completed_at": "2025-05-14T12:13:00.471154Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.472154Z", "completed_at": "2025-05-14T12:13:00.472154Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005000114440917969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_geographical_distribution_store_city.054f25f91f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect store_city\nfrom RAW.RAW_SIMULATION.geographical_distribution\nwhere store_city is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.473156Z", "completed_at": "2025-05-14T12:13:00.477155Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.477155Z", "completed_at": "2025-05-14T12:13:00.477155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003998756408691406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_customer_ltv_customer_id.6e2035d30b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom RAW.RAW_SIMULATION.customer_ltv\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.479155Z", "completed_at": "2025-05-14T12:13:00.484154Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.484154Z", "completed_at": "2025-05-14T12:13:00.484154Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005998849868774414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_customer_ltv_customer_ltv.d6e7a461b8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_ltv\nfrom RAW.RAW_SIMULATION.customer_ltv\nwhere customer_ltv is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.486193Z", "completed_at": "2025-05-14T12:13:00.489168Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.490156Z", "completed_at": "2025-05-14T12:13:00.490156Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004999876022338867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.unique_customer_ltv_customer_id.e975ef62fa", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom RAW.RAW_SIMULATION.customer_ltv\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.491162Z", "completed_at": "2025-05-14T12:13:00.496154Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.497155Z", "completed_at": "2025-05-14T12:13:00.497155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005993843078613281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_customer_repeat_rate_repeat_customer_rate_percentage.7ef0ab475e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect repeat_customer_rate_percentage\nfrom RAW.RAW_SIMULATION.customer_repeat_rate\nwhere repeat_customer_rate_percentage is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.498157Z", "completed_at": "2025-05-14T12:13:00.502154Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.502154Z", "completed_at": "2025-05-14T12:13:00.502154Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003997325897216797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_most_common_product_bundles_customer_id.d768ac05fb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom RAW.RAW_SIMULATION.most_common_product_bundles\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.504154Z", "completed_at": "2025-05-14T12:13:00.507155Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.508155Z", "completed_at": "2025-05-14T12:13:00.508155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004999876022338867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_most_common_product_bundles_product_1.f5964f3532", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_1\nfrom RAW.RAW_SIMULATION.most_common_product_bundles\nwhere product_1 is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.509154Z", "completed_at": "2025-05-14T12:13:00.513155Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.513155Z", "completed_at": "2025-05-14T12:13:00.513155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0040013790130615234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.unique_most_common_product_bundles_customer_id.83c2541cf8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom RAW.RAW_SIMULATION.most_common_product_bundles\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.515155Z", "completed_at": "2025-05-14T12:13:00.520155Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.520155Z", "completed_at": "2025-05-14T12:13:00.520155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00599980354309082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.accepted_values_best_selling_products_by_category_ranking_type__REVENUE__ORDERS.eadf94185e", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        ranking_type as value_field,\n        count(*) as n_records\n\n    from RAW.RAW_SIMULATION.best_selling_products_by_category\n    group by ranking_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'REVENUE','ORDERS'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.522154Z", "completed_at": "2025-05-14T12:13:00.525155Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.526155Z", "completed_at": "2025-05-14T12:13:00.526155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0050008296966552734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_best_selling_products_by_category_product_id.1a8f54d289", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom RAW.RAW_SIMULATION.best_selling_products_by_category\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.527154Z", "completed_at": "2025-05-14T12:13:00.531155Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.531155Z", "completed_at": "2025-05-14T12:13:00.531155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004000663757324219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_best_selling_products_by_category_ranking_type.e7d4d0602e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ranking_type\nfrom RAW.RAW_SIMULATION.best_selling_products_by_category\nwhere ranking_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.533154Z", "completed_at": "2025-05-14T12:13:00.537154Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.537154Z", "completed_at": "2025-05-14T12:13:00.537154Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004999637603759766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.accepted_values_product_performance_over_time_period_type__MONTH__WEEK.4e42cdc613", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        period_type as value_field,\n        count(*) as n_records\n\n    from RAW.RAW_SIMULATION.product_performance_over_time\n    group by period_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'MONTH','WEEK'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.539155Z", "completed_at": "2025-05-14T12:13:00.543156Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.543156Z", "completed_at": "2025-05-14T12:13:00.543156Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00500035285949707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_product_performance_over_time_date.dde24ce842", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date\nfrom RAW.RAW_SIMULATION.product_performance_over_time\nwhere date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.545154Z", "completed_at": "2025-05-14T12:13:00.549155Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.549155Z", "completed_at": "2025-05-14T12:13:00.549155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0050008296966552734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_product_performance_over_time_product_id.14f2506498", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom RAW.RAW_SIMULATION.product_performance_over_time\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.551156Z", "completed_at": "2025-05-14T12:13:00.556155Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.557155Z", "completed_at": "2025-05-14T12:13:00.557155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007000923156738281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.accepted_values_vip_or_non_vip_customer_behavior_most_purchased_category__Roupas__Eletr_nicos__Brinquedos__Alimentos__Livros.a7270ccc92", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        most_purchased_category as value_field,\n        count(*) as n_records\n\n    from RAW.RAW_SIMULATION.vip_or_non_vip_customer_behavior\n    group by most_purchased_category\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Roupas','Eletr\u00f4nicos','Brinquedos','Alimentos','Livros'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.558156Z", "completed_at": "2025-05-14T12:13:00.563155Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.563155Z", "completed_at": "2025-05-14T12:13:00.563155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004998683929443359, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_vip_or_non_vip_customer_behavior_customer_vip.5e4d226e7c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_vip\nfrom RAW.RAW_SIMULATION.vip_or_non_vip_customer_behavior\nwhere customer_vip is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:13:00.565155Z", "completed_at": "2025-05-14T12:13:00.568155Z"}, {"name": "execute", "started_at": "2025-05-14T12:13:00.568155Z", "completed_at": "2025-05-14T12:13:00.568155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004000425338745117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.unique_vip_or_non_vip_customer_behavior_customer_vip.0e33b5ead6", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_vip as unique_field,\n    count(*) as n_records\n\nfrom RAW.RAW_SIMULATION.vip_or_non_vip_customer_behavior\nwhere customer_vip is not null\ngroup by customer_vip\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 1.7066080570220947, "args": {"require_nested_cumulative_type_params": false, "require_batched_execution_for_custom_microbatch_strategy": false, "log_file_max_bytes": 10485760, "select": [], "log_format": "default", "macro_debugging": false, "invocation_command": "dbt docs generate", "static_parser": true, "send_anonymous_usage_stats": true, "strict_mode": false, "use_colors": true, "state_modified_compare_more_unrendered_values": false, "version_check": true, "require_yaml_configuration_for_mf_time_spines": false, "compile": true, "show_resource_report": false, "use_colors_file": true, "empty_catalog": false, "favor_state": false, "log_level": "info", "print": true, "log_format_file": "debug", "write_json": true, "project_dir": "C:\\Users\\vinic\\Projetos\\meus_projetos\\project-currency-conversion", "state_modified_compare_vars": false, "warn_error_options": {"include": [], "exclude": []}, "cache_selected_only": false, "static": false, "vars": {}, "log_level_file": "debug", "source_freshness_run_project_hooks": false, "defer": false, "quiet": false, "require_explicit_package_overrides_for_builtin_materializations": true, "introspect": true, "partial_parse_file_diff": true, "skip_nodes_if_on_run_start_fails": false, "which": "generate", "exclude": [], "printer_width": 80, "populate_cache": true, "indirect_selection": "eager", "log_path": "C:\\Users\\vinic\\Projetos\\meus_projetos\\project-currency-conversion\\logs", "profiles_dir": "C:/Users/vinic/Projetos/meus_projetos/project-currency-conversion", "require_resource_names_without_spaces": false, "partial_parse": true}}
