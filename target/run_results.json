{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-04-24T10:22:27.644753Z", "invocation_id": "8dbbd371-6a15-4340-a9e0-7af733f9c6e5", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-24T10:22:20.649148Z", "completed_at": "2025-04-24T10:22:20.660148Z"}, {"name": "execute", "started_at": "2025-04-24T10:22:20.661047Z", "completed_at": "2025-04-24T10:22:21.911495Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2654356956481934, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbe6ae-0000-d7ff-0000-8bb90009e006"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.project_currency_conversion.stg_raw_simulation__customer_product_mapping", "compiled": true, "compiled_code": "WITH columns_rename AS (\n    SELECT\n        \"id\" AS mapping_id,\n        \"cliente_id\" AS customer_id,\n        \"produto_id\" AS product_id\n\n    FROM RAW.RAW_SIMULATION.MAPEAMENTO_CLIENTE_PRODUTO\n\n)\n\nSELECT * FROM columns_rename", "relation_name": "RAW.RAW_SIMULATION.stg_raw_simulation__customer_product_mapping", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-24T10:22:21.925397Z", "completed_at": "2025-04-24T10:22:21.928393Z"}, {"name": "execute", "started_at": "2025-04-24T10:22:21.929392Z", "completed_at": "2025-04-24T10:22:22.353507Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.42911362648010254, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbe6ae-0000-d7e9-0000-8bb90009602e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.project_currency_conversion.stg_raw_simulation__customers", "compiled": true, "compiled_code": "WITH columns_rename AS (\n    SELECT\n\n        \"cliente_id\" AS customer_id,\n        \"nome\" AS customer_name,\n        \"email\" AS customer_email,\n        \"telefone\" AS customer_phone,\n        \"data_nascimento\" AS customer_date_of_birth,\n        \"vip\" AS customer_vip\n\n    FROM RAW.RAW_SIMULATION.CLIENTES\n\n),\n\nhandling_invalid_values AS (\n    SELECT\n        customer_id,\n        customer_name,\n        customer_date_of_birth,\n        customer_vip,\n        CASE\n            WHEN customer_email = 'emailinvalido.com' THEN 'INVALID_EMAIL'\n            ELSE customer_email\n        END AS customer_email,\n        CASE\n            WHEN trim(customer_phone) = '' THEN 'INVALID_PHONE'\n            ELSE customer_phone\n        END AS customer_phone\n\n    FROM columns_rename\n)\n\nSELECT * FROM handling_invalid_values", "relation_name": "RAW.RAW_SIMULATION.stg_raw_simulation__customers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-24T10:22:22.361306Z", "completed_at": "2025-04-24T10:22:22.365303Z"}, {"name": "execute", "started_at": "2025-04-24T10:22:22.365303Z", "completed_at": "2025-04-24T10:22:22.567298Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.20804715156555176, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbe6ae-0000-d816-0000-8bb90009c00a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.project_currency_conversion.stg_raw_simulation__exchange_rates", "compiled": true, "compiled_code": "WITH columns_renamed AS (\n    SELECT\n\n        original_total_value,\n        currency,\n        total_value_usd,\n        date_conversion\n\n    FROM RAW.RAW_SIMULATION.EXCHANGE_RATES\n\n)\n\nSELECT * FROM columns_renamed", "relation_name": "RAW.RAW_SIMULATION.stg_raw_simulation__exchange_rates", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-24T10:22:22.576302Z", "completed_at": "2025-04-24T10:22:22.582297Z"}, {"name": "execute", "started_at": "2025-04-24T10:22:22.583297Z", "completed_at": "2025-04-24T10:22:22.807671Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.23237323760986328, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbe6ae-0000-d7fd-0000-8bb90009d00a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.project_currency_conversion.stg_raw_simulation__products", "compiled": true, "compiled_code": "WITH columns_rename AS (\n    SELECT\n        \"produto_id\" AS product_id,\n        \"nome\" AS product_name,\n        \"categoria\" AS product_category,\n        \"preco\" AS product_price\n\n    FROM RAW.RAW_SIMULATION.PRODUTOS\n\n),\n\ntransforming_invalid_values AS (\n    SELECT\n        product_id,\n        product_name,\n        ABS(product_price) AS product_price,\n        CASE\n            WHEN product_category = 'Roupaz' THEN 'Roupas'\n            WHEN product_category = 'roupas' THEN 'Roupas'\n            ELSE product_category\n        END AS product_category\n\n    FROM columns_rename\n)\n\nSELECT * FROM transforming_invalid_values", "relation_name": "RAW.RAW_SIMULATION.stg_raw_simulation__products", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-24T10:22:22.814146Z", "completed_at": "2025-04-24T10:22:22.820132Z"}, {"name": "execute", "started_at": "2025-04-24T10:22:22.821121Z", "completed_at": "2025-04-24T10:22:23.322789Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5097544193267822, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbe6ae-0000-d80c-0000-8bb90009f006"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.project_currency_conversion.stg_raw_simulation__sales", "compiled": true, "compiled_code": "WITH columns_rename AS (\n    SELECT\n        venda_id AS sale_id,\n        data_venda AS sale_date,\n        cliente_id AS customer_id,\n        produto_id AS product_id,\n        loja_id AS store_id,\n        quantidade AS quantity_ordered,\n        preco_unitario AS product_unit_price,\n        valor_total AS sale_total_value,\n        moeda AS currency\n\n    FROM RAW.RAW_SIMULATION.VENDAS\n\n),\n\nadjusting_invalid_values AS (\n    SELECT\n\n        sale_id,\n        sale_date,\n        customer_id,\n        product_id,\n        store_id,\n        quantity_ordered,\n        currency,\n        ABS(product_unit_price) AS product_unit_price,\n        ABS(product_unit_price) * quantity_ordered AS sale_total_value\n\n    FROM columns_rename\n    WHERE quantity_ordered > 0\n)\n\nSELECT * FROM adjusting_invalid_values", "relation_name": "RAW.RAW_SIMULATION.stg_raw_simulation__sales", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-24T10:22:23.331779Z", "completed_at": "2025-04-24T10:22:23.338032Z"}, {"name": "execute", "started_at": "2025-04-24T10:22:23.338032Z", "completed_at": "2025-04-24T10:22:23.631297Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.30152249336242676, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbe6ae-0000-d815-0000-8bb90009b00a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.project_currency_conversion.stg_raw_simulation__stock", "compiled": true, "compiled_code": "WITH columns_rename AS (\n    SELECT\n        \"produto_id\" AS product_id,\n        \"loja_id\" AS store_id,\n        \"quantidade\" AS quantity_available\n\n    FROM RAW.RAW_SIMULATION.ESTOQUE\n\n)\n\nSELECT * FROM columns_rename", "relation_name": "RAW.RAW_SIMULATION.stg_raw_simulation__stock", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-24T10:22:23.635307Z", "completed_at": "2025-04-24T10:22:23.638294Z"}, {"name": "execute", "started_at": "2025-04-24T10:22:23.638294Z", "completed_at": "2025-04-24T10:22:23.889248Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.25496649742126465, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbe6ae-0000-d7ff-0000-8bb90009e00a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.project_currency_conversion.stg_raw_simulation__stores", "compiled": true, "compiled_code": "WITH columns_rename AS (\n    SELECT\n        \"loja_id\" AS store_id,\n        \"nome\" AS store_name,\n        \"cidade\" AS store_city,\n        \"estado\" AS state\n\n    FROM RAW.RAW_SIMULATION.LOJAS\n\n)\n\nSELECT * FROM columns_rename", "relation_name": "RAW.RAW_SIMULATION.stg_raw_simulation__stores", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-24T10:22:23.897271Z", "completed_at": "2025-04-24T10:22:23.907247Z"}, {"name": "execute", "started_at": "2025-04-24T10:22:23.908247Z", "completed_at": "2025-04-24T10:22:27.389055Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.4938032627105713, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0, "query_id": "01bbe6ae-0000-d7ff-0000-8bb90009e00e"}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.project_currency_conversion.int_sales_with_exchange_rates", "compiled": true, "compiled_code": "\n\n\nWITH applying_exchange_rates AS (\n    SELECT\n\n        s.sale_id,\n        s.sale_date,\n        ROUND(sale_total_value, 2) AS original_total_value,\n        s.currency,\n        CASE\n            WHEN s.currency = 'BRL' THEN ROUND(s.sale_total_value * 5.81, 2)\n            WHEN s.currency = 'MXN' THEN ROUND(s.sale_total_value * 19.71, 2)\n            WHEN s.currency = 'EUR' THEN ROUND(s.sale_total_value * 0.87, 2)\n            WHEN s.currency = 'USD' THEN s.sale_total_value\n        END AS total_value_usd,\n\n        CURRENT_DATE AS date_conversion\n\n    FROM RAW.RAW_SIMULATION.stg_raw_simulation__sales s\n    LEFT JOIN RAW.RAW_SIMULATION.stg_raw_simulation__exchange_rates e\n        ON s.currency = e.currency\n\n\n)\n\n\nSELECT *\nFROM applying_exchange_rates\n\n\n      where sale_id not in (select sale_id from RAW.RAW_SIMULATION.int_sales_with_exchange_rates)\n", "relation_name": "RAW.RAW_SIMULATION.int_sales_with_exchange_rates", "batch_results": null}], "elapsed_time": 8.925858497619629, "args": {"partial_parse": true, "send_anonymous_usage_stats": true, "warn_error_options": {"include": [], "exclude": []}, "log_format_file": "debug", "log_level": "info", "printer_width": 80, "skip_nodes_if_on_run_start_fails": false, "static_parser": true, "empty": false, "require_yaml_configuration_for_mf_time_spines": false, "populate_cache": true, "project_dir": "C:\\Users\\vinic\\Projetos\\meus_projetos\\project-currency-conversion", "indirect_selection": "eager", "log_path": "C:\\Users\\vinic\\Projetos\\meus_projetos\\project-currency-conversion\\logs", "source_freshness_run_project_hooks": false, "vars": {}, "invocation_command": "dbt run", "state_modified_compare_more_unrendered_values": false, "require_resource_names_without_spaces": false, "use_colors_file": true, "print": true, "state_modified_compare_vars": false, "introspect": true, "quiet": false, "log_format": "default", "log_level_file": "debug", "use_colors": true, "strict_mode": false, "which": "run", "partial_parse_file_diff": true, "version_check": true, "cache_selected_only": false, "require_nested_cumulative_type_params": false, "require_batched_execution_for_custom_microbatch_strategy": false, "write_json": true, "defer": false, "require_explicit_package_overrides_for_builtin_materializations": true, "log_file_max_bytes": 10485760, "macro_debugging": false, "profiles_dir": "C:\\Users\\vinic\\Projetos\\meus_projetos\\project-currency-conversion", "select": [], "favor_state": false, "exclude": [], "show_resource_report": false}}
