{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-05-05T10:05:35.824932Z", "invocation_id": "8dd95a3a-2b2a-49b5-b9a3-094260633026", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-05T10:05:33.519434Z", "completed_at": "2025-05-05T10:05:33.530434Z"}, {"name": "execute", "started_at": "2025-05-05T10:05:33.530434Z", "completed_at": "2025-05-05T10:05:34.221322Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7029001712799072, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bc247d-0000-db4c-0000-8bb900111062"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.project_currency_conversion.dim__customers", "compiled": true, "compiled_code": "WITH customers AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.int__customers_metrics\n),\n\ncustomers_metrics_joined AS (\n    SELECT\n\n        customer_id,\n        customer_name,\n        customer_vip,\n        total_customer_orders,\n        total_spend,\n        first_purchase,\n        last_purchase\n\n    FROM customers\n)\n\nSELECT * FROM customers_metrics_joined", "relation_name": "RAW.RAW_SIMULATION.dim__customers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-05T10:05:34.226307Z", "completed_at": "2025-05-05T10:05:34.229307Z"}, {"name": "execute", "started_at": "2025-05-05T10:05:34.229307Z", "completed_at": "2025-05-05T10:05:34.452031Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.22772645950317383, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bc247d-0000-db94-0000-8bb900116046"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.project_currency_conversion.dim__exchange_rates", "compiled": true, "compiled_code": "WITH exchange_rates AS (\n\n    SELECT *\n    FROM RAW.RAW_SIMULATION.int__sales_with_exchange_rates\n\n),\n\nexchange_rates_separation AS (\n\n    SELECT\n\n        currency AS of_currency,\n\n        'USD' AS to_currency,\n\n        ROUND(original_total_value / total_value_usd, 2) AS exchange_rate_used,\n\n        CURRENT_DATE AS exchange_rate_date\n\n    FROM exchange_rates\n\n)\n\nSELECT * FROM exchange_rates_separation", "relation_name": "RAW.RAW_SIMULATION.dim__exchange_rates", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-05T10:05:34.460722Z", "completed_at": "2025-05-05T10:05:34.466656Z"}, {"name": "execute", "started_at": "2025-05-05T10:05:34.467652Z", "completed_at": "2025-05-05T10:05:34.691048Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.23239445686340332, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bc247d-0000-db8f-0000-8bb900113062"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.project_currency_conversion.dim__products", "compiled": true, "compiled_code": "WITH products AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.int__products_metrics\n),\n\nproducts_metrics_joined AS (\n    SELECT\n\n        product_id,\n        product_name,\n        product_price,\n        product_category,\n        total_sales_count,\n        total_revenue_usd,\n        average_sale_value_usd,\n        first_sale_product,\n        last_sale_product\n\n    FROM products\n)\n\nSELECT * FROM products_metrics_joined", "relation_name": "RAW.RAW_SIMULATION.dim__products", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-05T10:05:34.699391Z", "completed_at": "2025-05-05T10:05:34.703365Z"}, {"name": "execute", "started_at": "2025-05-05T10:05:34.704364Z", "completed_at": "2025-05-05T10:05:35.058670Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.360304594039917, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bc247d-0000-db37-0000-8bb90011505a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.project_currency_conversion.dim__stores", "compiled": true, "compiled_code": "WITH stores AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.int__stores_metrics\n),\n\nstores_metrics_joined AS (\n\n    SELECT\n\n        store_id,\n        store_name,\n        store_city,\n        state,\n        total_sales_store,\n        total_revenue_store_usd,\n        average_sale_value_usd,\n        first_sale,\n        last_sale\n\n    FROM stores\n)\n\nSELECT * FROM stores_metrics_joined", "relation_name": "RAW.RAW_SIMULATION.dim__stores", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-05T10:05:35.066658Z", "completed_at": "2025-05-05T10:05:35.070660Z"}, {"name": "execute", "started_at": "2025-05-05T10:05:35.071658Z", "completed_at": "2025-05-05T10:05:35.312902Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.24824023246765137, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bc247d-0000-db4c-0000-8bb900111066"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.project_currency_conversion.fct__sales", "compiled": true, "compiled_code": "WITH sales AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.int__sales_with_exchange_rates\n),\n\nsales_with_metrics_usd AS (\n    SELECT\n        sale_id,\n        sale_date,\n        customer_id,\n        product_id,\n        store_id,\n        product_unit_price,\n        quantity_ordered,\n        'USD' as currency,\n        original_total_value,\n        total_value_usd,\n        conversion_date\n\n    FROM sales\n)\n\nSELECT * FROM sales_with_metrics_usd", "relation_name": "RAW.RAW_SIMULATION.fct__sales", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-05T10:05:35.320792Z", "completed_at": "2025-05-05T10:05:35.327792Z"}, {"name": "execute", "started_at": "2025-05-05T10:05:35.328794Z", "completed_at": "2025-05-05T10:05:35.578276Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.26048707962036133, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bc247d-0000-db94-0000-8bb90011604a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.project_currency_conversion.best_selling_products_by_category", "compiled": true, "compiled_code": "WITH products AS (\n\n    SELECT *\n    FROM RAW.RAW_SIMULATION.dim__products\n),\n\n\nbest_selling_products_by_category_revenue AS (\n\n    SELECT\n\n        p.product_id,\n        p.product_name,\n        p.product_category,\n        p.total_revenue_usd,\n\n        RANK() OVER (\n            PARTITION BY p.product_category\n            ORDER BY ROUND(p.total_revenue_usd, 2) DESC) AS rank_products\n\n    FROM products p\n    QUALIFY rank_products <= 5\n),\n\nbest_selling_products_by_category_orders AS (\n\n    SELECT\n\n        p.product_id,\n        p.product_name,\n        p.product_category,\n        p.total_sales_count,\n\n        RANK() OVER (\n            PARTITION BY p.product_category\n            ORDER BY p.total_sales_count DESC) AS rank_products\n\n    FROM products p\n    QUALIFY rank_products <= 5\n)\n\nSELECT\n\n    product_id,\n    product_name,\n    product_category,\n    ROUND(total_revenue_usd) AS total_revenue_and_orders,\n    rank_products,\n    'REVENUE' AS ranking_type\n\nFROM best_selling_products_by_category_revenue\n\nUNION ALL\n\nSELECT\n\n    product_id,\n    product_name,\n    product_category,\n    total_sales_count AS total_sales,\n    rank_products,\n    'ORDERS' AS ranking_type\n\nFROM best_selling_products_by_category_orders", "relation_name": "RAW.RAW_SIMULATION.best_selling_products_by_category", "batch_results": null}], "elapsed_time": 3.8832013607025146, "args": {"populate_cache": true, "strict_mode": false, "project_dir": "C:\\Users\\vinic\\Projetos\\meus_projetos\\project-currency-conversion", "require_yaml_configuration_for_mf_time_spines": false, "show_resource_report": false, "use_colors_file": true, "write_json": true, "log_level_file": "debug", "profiles_dir": "C:\\Users\\vinic\\Projetos\\meus_projetos\\project-currency-conversion", "exclude": [], "printer_width": 80, "version_check": true, "log_level": "info", "skip_nodes_if_on_run_start_fails": false, "quiet": false, "select": ["marts"], "log_file_max_bytes": 10485760, "log_format": "default", "invocation_command": "dbt run --select marts", "require_nested_cumulative_type_params": false, "defer": false, "cache_selected_only": false, "introspect": true, "require_batched_execution_for_custom_microbatch_strategy": false, "print": true, "partial_parse_file_diff": true, "require_resource_names_without_spaces": false, "state_modified_compare_vars": false, "partial_parse": true, "state_modified_compare_more_unrendered_values": false, "source_freshness_run_project_hooks": false, "static_parser": true, "favor_state": false, "macro_debugging": false, "vars": {}, "log_format_file": "debug", "send_anonymous_usage_stats": true, "indirect_selection": "eager", "which": "run", "log_path": "C:\\Users\\vinic\\Projetos\\meus_projetos\\project-currency-conversion\\logs", "require_explicit_package_overrides_for_builtin_materializations": true, "warn_error_options": {"include": [], "exclude": []}, "empty": false, "use_colors": true}}
