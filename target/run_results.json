{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-05-14T12:40:44.237285Z", "invocation_id": "d995da1a-0916-4313-b818-d2e9e415a5d4", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.503019Z", "completed_at": "2025-05-14T12:40:43.511018Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.512004Z", "completed_at": "2025-05-14T12:40:43.512004Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009984254837036133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.stg_raw_simulation__customer_product_mapping", "compiled": true, "compiled_code": "WITH columns_rename AS (\n    SELECT\n        \"id\" AS mapping_id,\n        \"cliente_id\" AS customer_id,\n        \"produto_id\" AS product_id\n\n    FROM RAW.RAW_SIMULATION.MAPEAMENTO_CLIENTE_PRODUTO\n\n)\n\nSELECT * FROM columns_rename", "relation_name": "RAW.RAW_SIMULATION.stg_raw_simulation__customer_product_mapping", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.513809Z", "completed_at": "2025-05-14T12:40:43.515816Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.516816Z", "completed_at": "2025-05-14T12:40:43.516816Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0037941932678222656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.stg_raw_simulation__customers", "compiled": true, "compiled_code": "WITH columns_rename AS (\n    SELECT\n\n        \"cliente_id\" AS customer_id,\n        \"nome\" AS customer_name,\n        \"email\" AS customer_email,\n        \"telefone\" AS customer_phone,\n        \"data_nascimento\" AS customer_date_of_birth,\n        \"vip\" AS customer_vip\n\n    FROM RAW.RAW_SIMULATION.CLIENTES\n\n),\n\nhandling_invalid_values AS (\n    SELECT\n        customer_id,\n        customer_name,\n        customer_date_of_birth,\n        customer_vip,\n        CASE\n            WHEN customer_email = 'emailinvalido.com' THEN 'INVALID_EMAIL'\n            ELSE customer_email\n        END AS customer_email,\n        CASE\n            WHEN trim(customer_phone) = '' THEN 'INVALID_PHONE'\n            ELSE customer_phone\n        END AS customer_phone\n\n    FROM columns_rename\n)\n\nSELECT * FROM handling_invalid_values", "relation_name": "RAW.RAW_SIMULATION.stg_raw_simulation__customers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.517818Z", "completed_at": "2025-05-14T12:40:43.520815Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.520815Z", "completed_at": "2025-05-14T12:40:43.520815Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0039997100830078125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.stg_raw_simulation__exchange_rates", "compiled": true, "compiled_code": "WITH columns_renamed AS (\n    SELECT\n\n        original_total_value,\n        currency,\n        total_value_usd,\n        date_conversion\n\n    FROM RAW.RAW_SIMULATION.EXCHANGE_RATES\n\n)\n\nSELECT * FROM columns_renamed", "relation_name": "RAW.RAW_SIMULATION.stg_raw_simulation__exchange_rates", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.522816Z", "completed_at": "2025-05-14T12:40:43.525815Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.525815Z", "completed_at": "2025-05-14T12:40:43.525815Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004998683929443359, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.stg_raw_simulation__products", "compiled": true, "compiled_code": "WITH columns_rename AS (\n    SELECT\n        \"produto_id\" AS product_id,\n        \"nome\" AS product_name,\n        \"categoria\" AS product_category,\n        \"preco\" AS product_price\n\n    FROM RAW.RAW_SIMULATION.PRODUTOS\n\n),\n\ntransforming_invalid_values AS (\n    SELECT\n        product_id,\n        product_name,\n        ABS(product_price) AS product_price,\n        CASE\n            WHEN product_category = 'Roupaz' THEN 'Roupas'\n            WHEN product_category = 'roupas' THEN 'Roupas'\n            ELSE product_category\n        END AS product_category\n\n    FROM columns_rename\n)\n\nSELECT * FROM transforming_invalid_values", "relation_name": "RAW.RAW_SIMULATION.stg_raw_simulation__products", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.527815Z", "completed_at": "2025-05-14T12:40:43.530816Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.530816Z", "completed_at": "2025-05-14T12:40:43.530816Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004000186920166016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.stg_raw_simulation__sales", "compiled": true, "compiled_code": "WITH columns_rename AS (\n    SELECT\n        venda_id AS sale_id,\n        data_venda AS sale_date,\n        cliente_id AS customer_id,\n        produto_id AS product_id,\n        loja_id AS store_id,\n        quantidade AS quantity_ordered,\n        preco_unitario AS product_unit_price,\n        valor_total AS sale_total_value,\n        moeda AS currency\n\n    FROM RAW.RAW_SIMULATION.VENDAS\n\n),\n\nadjusting_invalid_values AS (\n    SELECT\n\n        sale_id,\n        sale_date,\n        customer_id,\n        product_id,\n        store_id,\n        quantity_ordered,\n        currency,\n        ABS(product_unit_price) AS product_unit_price,\n        ABS(product_unit_price) * quantity_ordered AS sale_total_value\n\n    FROM columns_rename\n    WHERE quantity_ordered > 0\n)\n\nSELECT * FROM adjusting_invalid_values", "relation_name": "RAW.RAW_SIMULATION.stg_raw_simulation__sales", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.532816Z", "completed_at": "2025-05-14T12:40:43.534815Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.535816Z", "completed_at": "2025-05-14T12:40:43.535816Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004000425338745117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.stg_raw_simulation__stock", "compiled": true, "compiled_code": "WITH columns_rename AS (\n    SELECT\n        \"produto_id\" AS product_id,\n        \"loja_id\" AS store_id,\n        \"quantidade\" AS quantity_available\n\n    FROM RAW.RAW_SIMULATION.ESTOQUE\n\n)\n\nSELECT * FROM columns_rename", "relation_name": "RAW.RAW_SIMULATION.stg_raw_simulation__stock", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.537815Z", "completed_at": "2025-05-14T12:40:43.539816Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.540816Z", "completed_at": "2025-05-14T12:40:43.540816Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004000425338745117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.stg_raw_simulation__stores", "compiled": true, "compiled_code": "WITH columns_rename AS (\n    SELECT\n        \"loja_id\" AS store_id,\n        \"nome\" AS store_name,\n        \"cidade\" AS store_city,\n        \"estado\" AS state\n\n    FROM RAW.RAW_SIMULATION.LOJAS\n\n)\n\nSELECT * FROM columns_rename", "relation_name": "RAW.RAW_SIMULATION.stg_raw_simulation__stores", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.542816Z", "completed_at": "2025-05-14T12:40:43.546815Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.546815Z", "completed_at": "2025-05-14T12:40:43.546815Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004998683929443359, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.accepted_values_stg_raw_simulation__customers_customer_vip__TRUE__FALSE.9a40660dbe", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_vip as value_field,\n        count(*) as n_records\n\n    from RAW.RAW_SIMULATION.stg_raw_simulation__customers\n    group by customer_vip\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'TRUE','FALSE'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.548815Z", "completed_at": "2025-05-14T12:40:43.555817Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.555817Z", "completed_at": "2025-05-14T12:40:43.555817Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007999897003173828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_stg_raw_simulation__customers_customer_id.81c0f76866", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom RAW.RAW_SIMULATION.stg_raw_simulation__customers\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.557815Z", "completed_at": "2025-05-14T12:40:43.560816Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.560816Z", "completed_at": "2025-05-14T12:40:43.560816Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004998207092285156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_stg_raw_simulation__customers_customer_vip.78b1a7839f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_vip\nfrom RAW.RAW_SIMULATION.stg_raw_simulation__customers\nwhere customer_vip is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.562816Z", "completed_at": "2025-05-14T12:40:43.567816Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.567816Z", "completed_at": "2025-05-14T12:40:43.567816Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006000041961669922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.unique_stg_raw_simulation__customers_customer_id.c9e6075042", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom RAW.RAW_SIMULATION.stg_raw_simulation__customers\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.569815Z", "completed_at": "2025-05-14T12:40:43.573816Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.573816Z", "completed_at": "2025-05-14T12:40:43.573816Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004998683929443359, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_stg_raw_simulation__products_product_id.f95b58f68e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom RAW.RAW_SIMULATION.stg_raw_simulation__products\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.574840Z", "completed_at": "2025-05-14T12:40:43.578831Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.578831Z", "completed_at": "2025-05-14T12:40:43.578831Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003990650177001953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_stg_raw_simulation__products_product_price.fc92677b9a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_price\nfrom RAW.RAW_SIMULATION.stg_raw_simulation__products\nwhere product_price is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.580820Z", "completed_at": "2025-05-14T12:40:43.584818Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.584818Z", "completed_at": "2025-05-14T12:40:43.584818Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0049974918365478516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.unique_stg_raw_simulation__products_product_id.3717f09c91", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_id as unique_field,\n    count(*) as n_records\n\nfrom RAW.RAW_SIMULATION.stg_raw_simulation__products\nwhere product_id is not null\ngroup by product_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.586840Z", "completed_at": "2025-05-14T12:40:43.591592Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.591592Z", "completed_at": "2025-05-14T12:40:43.591592Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0057718753814697266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.int__sales_with_exchange_rates", "compiled": true, "compiled_code": "\n\n\nWITH applying_exchange_rates AS (\n    SELECT\n\n        s.sale_id,\n        s.sale_date,\n        s.customer_id,\n        s.product_id,\n        s.store_id,\n        s.product_unit_price,\n        s.quantity_ordered,\n        s.currency,\n        ROUND(sale_total_value, 2) AS original_total_value,\n        CASE\n            WHEN s.currency = 'BRL' THEN ROUND(s.sale_total_value * 0.18, 2)\n            WHEN s.currency = 'MXN' THEN ROUND(s.sale_total_value * 0.05, 2)\n            WHEN s.currency = 'EUR' THEN ROUND(s.sale_total_value * 1.14, 2)\n            WHEN s.currency = 'USD' THEN s.sale_total_value\n        END AS total_value_usd,\n\n        CURRENT_DATE AS conversion_date\n\n    FROM RAW.RAW_SIMULATION.stg_raw_simulation__sales s\n    LEFT JOIN RAW.RAW_SIMULATION.stg_raw_simulation__exchange_rates e\n        ON s.currency = e.currency\n\n)\n\nSELECT *\nFROM applying_exchange_rates\n\n\n    WHERE sale_id NOT IN (SELECT sale_id FROM RAW.RAW_SIMULATION.int__sales_with_exchange_rates)\n", "relation_name": "RAW.RAW_SIMULATION.int__sales_with_exchange_rates", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.593597Z", "completed_at": "2025-05-14T12:40:43.597597Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.597597Z", "completed_at": "2025-05-14T12:40:43.597597Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005000114440917969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.accepted_values_stg_raw_simulation__sales_currency__BRL__USD__MXN__EUR.59d7c22155", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        currency as value_field,\n        count(*) as n_records\n\n    from RAW.RAW_SIMULATION.stg_raw_simulation__sales\n    group by currency\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'BRL','USD','MXN','EUR'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.599600Z", "completed_at": "2025-05-14T12:40:43.603700Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.604604Z", "completed_at": "2025-05-14T12:40:43.604604Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0050048828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_stg_raw_simulation__sales_currency.a1fea0633c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect currency\nfrom RAW.RAW_SIMULATION.stg_raw_simulation__sales\nwhere currency is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.605716Z", "completed_at": "2025-05-14T12:40:43.609707Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.609707Z", "completed_at": "2025-05-14T12:40:43.609707Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005102872848510742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_stg_raw_simulation__sales_customer_id.7bc3d7c514", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom RAW.RAW_SIMULATION.stg_raw_simulation__sales\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.611613Z", "completed_at": "2025-05-14T12:40:43.614599Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.615597Z", "completed_at": "2025-05-14T12:40:43.615597Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004993438720703125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_stg_raw_simulation__sales_sale_id.e2a1b8a690", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sale_id\nfrom RAW.RAW_SIMULATION.stg_raw_simulation__sales\nwhere sale_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.616597Z", "completed_at": "2025-05-14T12:40:43.621598Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.621598Z", "completed_at": "2025-05-14T12:40:43.621598Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005000591278076172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_stg_raw_simulation__sales_sale_total_value.1f1d790115", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sale_total_value\nfrom RAW.RAW_SIMULATION.stg_raw_simulation__sales\nwhere sale_total_value is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.623598Z", "completed_at": "2025-05-14T12:40:43.626598Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.627598Z", "completed_at": "2025-05-14T12:40:43.627598Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004999876022338867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.unique_stg_raw_simulation__sales_sale_id.7583375d16", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sale_id as unique_field,\n    count(*) as n_records\n\nfrom RAW.RAW_SIMULATION.stg_raw_simulation__sales\nwhere sale_id is not null\ngroup by sale_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.628600Z", "completed_at": "2025-05-14T12:40:43.631597Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.631597Z", "completed_at": "2025-05-14T12:40:43.631597Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003999471664428711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.stock_health", "compiled": true, "compiled_code": "\n\nWITH stock AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.stg_raw_simulation__stock\n),\n\nstock_levels AS (\n\n    SELECT\n        product_id,\n        store_id,\n        quantity_available,\n        CASE\n            WHEN quantity_available = 0 THEN 'ZERO_STOCK'\n            WHEN quantity_available < 0 THEN 'NEGATIVE_STOCK'\n            ELSE 'OK'\n        END AS stock_status\n\n    FROM stock\n)\n\nSELECT * FROM stock_levels", "relation_name": "RAW.RAW_SIMULATION.stock_health", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.634597Z", "completed_at": "2025-05-14T12:40:43.638601Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.639602Z", "completed_at": "2025-05-14T12:40:43.639602Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006001472473144531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.relationships_stg_raw_simulation__stock_product_id__product_id__ref_stg_raw_simulation__products_.f3cf3dc923", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_id as from_field\n    from RAW.RAW_SIMULATION.stg_raw_simulation__stock\n    where product_id is not null\n),\n\nparent as (\n    select product_id as to_field\n    from RAW.RAW_SIMULATION.stg_raw_simulation__products\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.641614Z", "completed_at": "2025-05-14T12:40:43.645612Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.645612Z", "completed_at": "2025-05-14T12:40:43.645612Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004998683929443359, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_stg_raw_simulation__stores_store_id.b79d027d4d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect store_id\nfrom RAW.RAW_SIMULATION.stg_raw_simulation__stores\nwhere store_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.647616Z", "completed_at": "2025-05-14T12:40:43.652612Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.652612Z", "completed_at": "2025-05-14T12:40:43.652612Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005987882614135742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.relationships_stg_raw_simulation__stock_store_id__store_id__ref_stg_raw_simulation__stores_.af63dc69f6", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select store_id as from_field\n    from RAW.RAW_SIMULATION.stg_raw_simulation__stock\n    where store_id is not null\n),\n\nparent as (\n    select store_id as to_field\n    from RAW.RAW_SIMULATION.stg_raw_simulation__stores\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.654784Z", "completed_at": "2025-05-14T12:40:43.657781Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.657781Z", "completed_at": "2025-05-14T12:40:43.657781Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005003690719604492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.unique_stg_raw_simulation__stores_store_id.fcdc1cff5e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    store_id as unique_field,\n    count(*) as n_records\n\nfrom RAW.RAW_SIMULATION.stg_raw_simulation__stores\nwhere store_id is not null\ngroup by store_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.659792Z", "completed_at": "2025-05-14T12:40:43.662794Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.663770Z", "completed_at": "2025-05-14T12:40:43.663770Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0050046443939208984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.dm__exchange_rates", "compiled": true, "compiled_code": "WITH exchange_rates AS (\n\n    SELECT *\n    FROM RAW.RAW_SIMULATION.int__sales_with_exchange_rates\n\n),\n\nexchange_rates_separation AS (\n\n    SELECT\n\n        currency AS of_currency,\n\n        'USD' AS to_currency,\n\n        ROUND(original_total_value / total_value_usd, 2) AS exchange_rate_used,\n\n        CURRENT_DATE AS exchange_rate_date\n\n    FROM exchange_rates\n\n)\n\nSELECT * FROM exchange_rates_separation", "relation_name": "RAW.RAW_SIMULATION.dm__exchange_rates", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.664782Z", "completed_at": "2025-05-14T12:40:43.667781Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.667781Z", "completed_at": "2025-05-14T12:40:43.667781Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0029993057250976562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.fct_sales__finance_metrics_usd", "compiled": true, "compiled_code": "WITH sales AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.int__sales_with_exchange_rates\n),\n\nsales_with_metrics_usd AS (\n    SELECT\n        sale_id,\n        sale_date,\n        customer_id,\n        product_id,\n        store_id,\n        product_unit_price,\n        quantity_ordered,\n        'USD' AS currency,\n        total_value_usd AS total_value,\n        conversion_date\n\n    FROM sales\n)\n\nSELECT * FROM sales_with_metrics_usd", "relation_name": "RAW.RAW_SIMULATION.fct_sales__finance_metrics_usd", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.669781Z", "completed_at": "2025-05-14T12:40:43.672780Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.672780Z", "completed_at": "2025-05-14T12:40:43.672780Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0049860477447509766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.int__customers_metrics", "compiled": true, "compiled_code": "\n\n\nWITH source AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.stg_raw_simulation__customers\n\n),\n\nmetrics AS (\n    SELECT\n        c.customer_id,\n        c.customer_name,\n        c.customer_vip,\n        COUNT(s.sale_id) AS total_customer_orders,\n        SUM(s.total_value_usd) AS total_spend,\n        MIN(s.sale_date) AS first_purchase,\n        MAX(s.sale_date) AS last_purchase\n    FROM source c\n    LEFT JOIN RAW.RAW_SIMULATION.int__sales_with_exchange_rates s ON c.customer_id = s.customer_id AND sale_date IS NOT NULL\n    GROUP BY c.customer_id, c.customer_name, c.customer_vip\n)\n\nSELECT * FROM metrics\n\n\n\n    WHERE last_purchase > (\n        SELECT MAX(last_purchase)\n        FROM RAW.RAW_SIMULATION.int__customers_metrics\n        WHERE customer_id = metrics.customer_id\n    )\n", "relation_name": "RAW.RAW_SIMULATION.int__customers_metrics", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.674765Z", "completed_at": "2025-05-14T12:40:43.677780Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.678767Z", "completed_at": "2025-05-14T12:40:43.678767Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004999399185180664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.int__products_metrics", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.stg_raw_simulation__products\n\n),\n\nmetrics AS (\n\n    SELECT\n        p.product_id,\n        p.product_name,\n        p.product_price,\n        p.product_category,\n        COUNT(s.quantity_ordered) AS total_unit_sold,\n        SUM(total_value_usd) AS total_revenue_usd,\n        ROUND(total_revenue_usd / total_unit_sold, 2) AS average_sale_value_usd,\n        MIN(s.sale_date) AS first_sale_product,\n        MAX(s.sale_date) AS last_sale_product\n\n    FROM source p\n    LEFT JOIN RAW.RAW_SIMULATION.int__sales_with_exchange_rates s ON p.product_id = s.product_id\n    GROUP BY\n        p.product_id,\n        p.product_name,\n        p.product_price,\n        p.product_category\n\n)\n\nSELECT * FROM metrics\n\n\n\n    WHERE last_sale_product > (\n        SELECT MAX(last_sale_product)\n        FROM RAW.RAW_SIMULATION.int__products_metrics\n        WHERE product_id = metrics.product_id\n    )\n", "relation_name": "RAW.RAW_SIMULATION.int__products_metrics", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.680765Z", "completed_at": "2025-05-14T12:40:43.683765Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.684782Z", "completed_at": "2025-05-14T12:40:43.684782Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005017518997192383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.int__stores_metrics", "compiled": true, "compiled_code": "\n\n\nWITH source AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.stg_raw_simulation__stores\n),\n\nmetrics AS (\n\n    SELECT\n        s.store_id,\n        s.store_name,\n        s.store_city,\n        s.state,\n        COUNT(e.sale_id) AS total_sales_store,\n        SUM(e.total_value_usd) AS total_revenue_store_usd,\n        ROUND(total_revenue_store_usd / total_sales_store, 2) AS average_sale_value_usd,\n        MIN(e.sale_date) AS first_sale,\n        MAX(e.sale_date) AS last_sale\n\n    FROM source s\n    LEFT JOIN RAW.RAW_SIMULATION.int__sales_with_exchange_rates e ON s.store_id = e.store_id\n    GROUP BY\n        s.store_id,\n        s.store_name,\n        s.store_city,\n        s.state\n)\n\nSELECT * FROM metrics\n\n\n\n    WHERE last_sale > (\n        SELECT MAX(last_sale)\n        FROM RAW.RAW_SIMULATION.int__stores_metrics\n        WHERE store_id = metrics.store_id\n    )\n", "relation_name": "RAW.RAW_SIMULATION.int__stores_metrics", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.685977Z", "completed_at": "2025-05-14T12:40:43.689085Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.689085Z", "completed_at": "2025-05-14T12:40:43.689085Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0031082630157470703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.sales_by_currency", "compiled": true, "compiled_code": "\n\nWITH sales AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.int__sales_with_exchange_rates\n),\n\ntotal_values_by_currency AS (\n    SELECT\n\n        currency,\n        ROUND(SUM(original_total_value)) AS total_sold_by_currency\n\n    FROM sales\n    GROUP BY currency\n),\n\nsale_total_value AS (\n    SELECT\n\n        SUM(total_sold_by_currency) AS value_total\n\n    FROM total_values_by_currency\n),\n\nsales_by_currency AS (\n    SELECT\n\n        tvc.currency,\n        tvc.total_sold_by_currency,\n        ROUND(tvc.total_sold_by_currency * 100 / stv.value_total, 2) || '%' AS percentage_of_foreign_exchange_exposure\n\n    FROM sale_total_value stv\n    INNER JOIN total_values_by_currency tvc\n)\n\nSELECT * FROM sales_by_currency\nORDER BY percentage_of_foreign_exchange_exposure DESC", "relation_name": "RAW.RAW_SIMULATION.sales_by_currency", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.691000Z", "completed_at": "2025-05-14T12:40:43.694088Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.694985Z", "completed_at": "2025-05-14T12:40:43.694985Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004892826080322266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.accepted_values_int__sales_with_exchange_rates_currency__BRL__USD__MXN__EUR.9e32425f90", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        currency as value_field,\n        count(*) as n_records\n\n    from RAW.RAW_SIMULATION.int__sales_with_exchange_rates\n    group by currency\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'BRL','USD','MXN','EUR'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.696086Z", "completed_at": "2025-05-14T12:40:43.700089Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.701098Z", "completed_at": "2025-05-14T12:40:43.701098Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005011558532714844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_int__sales_with_exchange_rates_currency.97a6828700", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect currency\nfrom RAW.RAW_SIMULATION.int__sales_with_exchange_rates\nwhere currency is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.702099Z", "completed_at": "2025-05-14T12:40:43.705997Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.705997Z", "completed_at": "2025-05-14T12:40:43.705997Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0038983821868896484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_int__sales_with_exchange_rates_original_total_value.ccca33ea0b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect original_total_value\nfrom RAW.RAW_SIMULATION.int__sales_with_exchange_rates\nwhere original_total_value is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.708001Z", "completed_at": "2025-05-14T12:40:43.710997Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.711998Z", "completed_at": "2025-05-14T12:40:43.711998Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004999399185180664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_int__sales_with_exchange_rates_sale_id.620f7481c4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sale_id\nfrom RAW.RAW_SIMULATION.int__sales_with_exchange_rates\nwhere sale_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.712997Z", "completed_at": "2025-05-14T12:40:43.716982Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.716982Z", "completed_at": "2025-05-14T12:40:43.716982Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004984617233276367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_int__sales_with_exchange_rates_total_value_usd.69290a3117", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_value_usd\nfrom RAW.RAW_SIMULATION.int__sales_with_exchange_rates\nwhere total_value_usd is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.717998Z", "completed_at": "2025-05-14T12:40:43.721982Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.721982Z", "completed_at": "2025-05-14T12:40:43.721982Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003984689712524414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.unique_int__sales_with_exchange_rates_sale_id.9f31db78bc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sale_id as unique_field,\n    count(*) as n_records\n\nfrom RAW.RAW_SIMULATION.int__sales_with_exchange_rates\nwhere sale_id is not null\ngroup by sale_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.723997Z", "completed_at": "2025-05-14T12:40:43.726998Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.727983Z", "completed_at": "2025-05-14T12:40:43.727983Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005001068115234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.accepted_values_stock_health_stock_status__OK__ZERO_STOCK__NEGATIVE_STOCK.fc8a5b3e8f", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        stock_status as value_field,\n        count(*) as n_records\n\n    from RAW.RAW_SIMULATION.stock_health\n    group by stock_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'OK','ZERO_STOCK','NEGATIVE_STOCK'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.728997Z", "completed_at": "2025-05-14T12:40:43.733997Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.733997Z", "completed_at": "2025-05-14T12:40:43.733997Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005000114440917969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_stock_health_product_id.00b3b4b68c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom RAW.RAW_SIMULATION.stock_health\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.734984Z", "completed_at": "2025-05-14T12:40:43.738997Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.738997Z", "completed_at": "2025-05-14T12:40:43.738997Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004014015197753906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_stock_health_store_id.5d5bbecc01", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect store_id\nfrom RAW.RAW_SIMULATION.stock_health\nwhere store_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.740986Z", "completed_at": "2025-05-14T12:40:43.743984Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.743984Z", "completed_at": "2025-05-14T12:40:43.743984Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0039861202239990234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.sales_per_day_and_average_ticket", "compiled": true, "compiled_code": "\n\nWITH sales AS (\n\n    SELECT *\n    FROM RAW.RAW_SIMULATION.fct_sales__finance_metrics_usd\n),\n\nsales_by_day AS (\n    SELECT\n        DATE_TRUNC('day', sale_date) AS sale_date,\n        COUNT(DISTINCT sale_id) AS sales_by_day,\n        ROUND(AVG(total_value)) AS average_ticket\n    FROM sales\n    GROUP BY sale_date\n)\n\nSELECT * FROM sales_by_day\nORDER BY sale_date", "relation_name": "RAW.RAW_SIMULATION.sales_per_day_and_average_ticket", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.746450Z", "completed_at": "2025-05-14T12:40:43.750466Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.750466Z", "completed_at": "2025-05-14T12:40:43.750466Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004015445709228516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.accepted_values_fct_sales__finance_metrics_usd_currency__USD.dc2ecb42f7", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        currency as value_field,\n        count(*) as n_records\n\n    from RAW.RAW_SIMULATION.fct_sales__finance_metrics_usd\n    group by currency\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'USD'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.752465Z", "completed_at": "2025-05-14T12:40:43.756475Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.756475Z", "completed_at": "2025-05-14T12:40:43.756475Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005008697509765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_fct_sales__finance_metrics_usd_currency.cb26c6ad68", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect currency\nfrom RAW.RAW_SIMULATION.fct_sales__finance_metrics_usd\nwhere currency is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.758101Z", "completed_at": "2025-05-14T12:40:43.762106Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.762106Z", "completed_at": "2025-05-14T12:40:43.762106Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004004716873168945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_fct_sales__finance_metrics_usd_sale_id.12c2bc8627", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sale_id\nfrom RAW.RAW_SIMULATION.fct_sales__finance_metrics_usd\nwhere sale_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.764160Z", "completed_at": "2025-05-14T12:40:43.768212Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.768212Z", "completed_at": "2025-05-14T12:40:43.768212Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005105018615722656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_fct_sales__finance_metrics_usd_total_value.88c9938e49", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_value\nfrom RAW.RAW_SIMULATION.fct_sales__finance_metrics_usd\nwhere total_value is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.769108Z", "completed_at": "2025-05-14T12:40:43.774213Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.774213Z", "completed_at": "2025-05-14T12:40:43.774213Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005104780197143555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.unique_fct_sales__finance_metrics_usd_sale_id.9f23004c8b", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sale_id as unique_field,\n    count(*) as n_records\n\nfrom RAW.RAW_SIMULATION.fct_sales__finance_metrics_usd\nwhere sale_id is not null\ngroup by sale_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.776115Z", "completed_at": "2025-05-14T12:40:43.778106Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.779107Z", "completed_at": "2025-05-14T12:40:43.779107Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003999233245849609, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.dm__customers_metrics", "compiled": true, "compiled_code": "WITH customers AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.int__customers_metrics\n),\n\ncustomers_metrics_joined AS (\n    SELECT\n\n        customer_id,\n        customer_name,\n        customer_vip,\n        total_customer_orders,\n        total_spend,\n        first_purchase,\n        last_purchase\n\n    FROM customers\n)\n\nSELECT * FROM customers_metrics_joined", "relation_name": "RAW.RAW_SIMULATION.dm__customers_metrics", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.780106Z", "completed_at": "2025-05-14T12:40:43.784129Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.785107Z", "completed_at": "2025-05-14T12:40:43.785107Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005001068115234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.accepted_values_int__customers_metrics_customer_vip__TRUE__FALSE.ba7f710b23", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_vip as value_field,\n        count(*) as n_records\n\n    from RAW.RAW_SIMULATION.int__customers_metrics\n    group by customer_vip\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'TRUE','FALSE'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.786107Z", "completed_at": "2025-05-14T12:40:43.790110Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.790110Z", "completed_at": "2025-05-14T12:40:43.790110Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005002498626708984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_int__customers_metrics_customer_id.d7c4f4c7a2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom RAW.RAW_SIMULATION.int__customers_metrics\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.791112Z", "completed_at": "2025-05-14T12:40:43.795110Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.795110Z", "completed_at": "2025-05-14T12:40:43.795110Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003998279571533203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.unique_int__customers_metrics_customer_id.9767483c35", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom RAW.RAW_SIMULATION.int__customers_metrics\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.797122Z", "completed_at": "2025-05-14T12:40:43.799122Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.799122Z", "completed_at": "2025-05-14T12:40:43.799122Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0039980411529541016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.dm__products_metrics", "compiled": true, "compiled_code": "WITH products AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.int__products_metrics\n),\n\nproducts_metrics_joined AS (\n    SELECT\n\n        product_id,\n        product_name,\n        product_price,\n        product_category,\n        total_unit_sold,\n        total_revenue_usd,\n        average_sale_value_usd,\n        first_sale_product,\n        last_sale_product\n\n    FROM products\n)\n\nSELECT * FROM products_metrics_joined", "relation_name": "RAW.RAW_SIMULATION.dm__products_metrics", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.801106Z", "completed_at": "2025-05-14T12:40:43.805181Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.806167Z", "completed_at": "2025-05-14T12:40:43.806167Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005061626434326172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_int__products_metrics_product_id.e5c183a8e0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom RAW.RAW_SIMULATION.int__products_metrics\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.808170Z", "completed_at": "2025-05-14T12:40:43.813165Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.814164Z", "completed_at": "2025-05-14T12:40:43.814164Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006983757019042969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.unique_int__products_metrics_product_id.511da6ff24", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_id as unique_field,\n    count(*) as n_records\n\nfrom RAW.RAW_SIMULATION.int__products_metrics\nwhere product_id is not null\ngroup by product_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.815164Z", "completed_at": "2025-05-14T12:40:43.818164Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.818164Z", "completed_at": "2025-05-14T12:40:43.818164Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0030002593994140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.dm__stores_metrics", "compiled": true, "compiled_code": "WITH stores AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.int__stores_metrics\n),\n\nstores_metrics_joined AS (\n\n    SELECT\n\n        store_id,\n        store_name,\n        store_city,\n        state,\n        total_sales_store,\n        total_revenue_store_usd,\n        average_sale_value_usd,\n        first_sale,\n        last_sale\n\n    FROM stores\n)\n\nSELECT * FROM stores_metrics_joined", "relation_name": "RAW.RAW_SIMULATION.dm__stores_metrics", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.820165Z", "completed_at": "2025-05-14T12:40:43.823164Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.823164Z", "completed_at": "2025-05-14T12:40:43.823164Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003998756408691406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.geographical_distribution", "compiled": true, "compiled_code": "\n\nWITH stores AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.int__stores_metrics\n),\n\nsales AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.fct_sales__finance_metrics_usd\n),\n\nstore_sales_by_state_and_city AS (\n    SELECT\n        st.store_city,\n        st.state,\n        COUNT(s.sale_id) AS total_sales,\n        ROUND(SUM(s.total_value)) AS revenue_generated\n\n    FROM stores st\n    LEFT JOIN sales s ON st.store_id = s.store_id\n    GROUP BY st.store_city, st.state\n)\n\nSELECT * FROM store_sales_by_state_and_city", "relation_name": "RAW.RAW_SIMULATION.geographical_distribution", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.825165Z", "completed_at": "2025-05-14T12:40:43.829184Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.829184Z", "completed_at": "2025-05-14T12:40:43.829184Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005019187927246094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.accepted_values_sales_by_currency_currency__BRL__USD__MXN__EUR.19283669ff", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        currency as value_field,\n        count(*) as n_records\n\n    from RAW.RAW_SIMULATION.sales_by_currency\n    group by currency\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'BRL','USD','MXN','EUR'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.831167Z", "completed_at": "2025-05-14T12:40:43.834179Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.835168Z", "completed_at": "2025-05-14T12:40:43.835168Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004997968673706055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_sales_by_currency_currency.25cb5876f6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect currency\nfrom RAW.RAW_SIMULATION.sales_by_currency\nwhere currency is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.836172Z", "completed_at": "2025-05-14T12:40:43.840179Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.840179Z", "completed_at": "2025-05-14T12:40:43.840179Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004006624221801758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.unique_sales_by_currency_currency.f83ca932dd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    currency as unique_field,\n    count(*) as n_records\n\nfrom RAW.RAW_SIMULATION.sales_by_currency\nwhere currency is not null\ngroup by currency\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.841166Z", "completed_at": "2025-05-14T12:40:43.846673Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.846673Z", "completed_at": "2025-05-14T12:40:43.846673Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005506992340087891, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_sales_per_day_and_average_ticket_sale_date.44388f8da9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sale_date\nfrom RAW.RAW_SIMULATION.sales_per_day_and_average_ticket\nwhere sale_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.848674Z", "completed_at": "2025-05-14T12:40:43.851659Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.852660Z", "completed_at": "2025-05-14T12:40:43.852660Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004983425140380859, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_sales_per_day_and_average_ticket_sales_by_day.baebe44b6f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sales_by_day\nfrom RAW.RAW_SIMULATION.sales_per_day_and_average_ticket\nwhere sales_by_day is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.853687Z", "completed_at": "2025-05-14T12:40:43.856674Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.856674Z", "completed_at": "2025-05-14T12:40:43.856674Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003974437713623047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.customer_ltv", "compiled": true, "compiled_code": "\n\nWITH customers AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.dm__customers_metrics\n),\n\nltv AS (\n    SELECT\n        customer_id,\n        customer_name,\n        total_spend AS customer_ltv\n    FROM customers\n)\n\nSELECT * FROM ltv", "relation_name": "RAW.RAW_SIMULATION.customer_ltv", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.858588Z", "completed_at": "2025-05-14T12:40:43.861706Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.862602Z", "completed_at": "2025-05-14T12:40:43.862602Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004014015197753906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.customer_repeat_rate", "compiled": true, "compiled_code": "\n\n\nWITH customers AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.dm__customers_metrics\n),\n\npercentage_of_repeat_customer_purchase AS (\n    SELECT\n\n        round(\n            count_if(total_customer_orders > 1) * 1.0 / count(*) * 100,\n            2\n        ) AS repeat_customer_rate_percentage\n\n    FROM customers\n)\n\nSELECT * FROM percentage_of_repeat_customer_purchase", "relation_name": "RAW.RAW_SIMULATION.customer_repeat_rate", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.863661Z", "completed_at": "2025-05-14T12:40:43.867056Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.867056Z", "completed_at": "2025-05-14T12:40:43.867056Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004454612731933594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.most_common_product_bundles", "compiled": true, "compiled_code": "\n\nWITH sales AS (\n\n    SELECT *\n    FROM RAW.RAW_SIMULATION.fct_sales__finance_metrics_usd\n),\n\ncustomers AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.dm__customers_metrics\n),\n\ntop_products_per_customer AS (\n    SELECT\n        c.customer_id,\n        c.customer_name,\n        s.product_id,\n        ROW_NUMBER() OVER (\n            PARTITION BY c.customer_id\n            ORDER BY COUNT(*) DESC\n        ) AS rank_products_purchased\n\n    FROM customers c\n    LEFT JOIN sales s ON c.customer_id = s.customer_id\n    GROUP BY c.customer_id, c.customer_name, s.product_id\n    QUALIFY rank_products_purchased <= 2\n),\n\nproduct_pairs AS (\n    SELECT\n        a.customer_id,\n        a.customer_name,\n        LEAST(a.product_id, b.product_id) AS product_1,\n        GREATEST(a.product_id, b.product_id) AS product_2\n    FROM top_products_per_customer a\n    INNER JOIN top_products_per_customer b\n    ON a.customer_id = b.customer_id AND a.product_id <> b.product_id\n    WHERE a.product_id < b.product_id\n)\n\nSELECT DISTINCT *\nFROM product_pairs", "relation_name": "RAW.RAW_SIMULATION.most_common_product_bundles", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.869092Z", "completed_at": "2025-05-14T12:40:43.873088Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.873088Z", "completed_at": "2025-05-14T12:40:43.873088Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00501251220703125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.accepted_values_dm__customers_metrics_customer_vip__TRUE__FALSE.65712c2a1a", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_vip as value_field,\n        count(*) as n_records\n\n    from RAW.RAW_SIMULATION.dm__customers_metrics\n    group by customer_vip\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'TRUE','FALSE'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.874077Z", "completed_at": "2025-05-14T12:40:43.878087Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.878087Z", "completed_at": "2025-05-14T12:40:43.878087Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004010677337646484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_dm__customers_metrics_customer_id.903c60a556", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom RAW.RAW_SIMULATION.dm__customers_metrics\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.880075Z", "completed_at": "2025-05-14T12:40:43.884088Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.885076Z", "completed_at": "2025-05-14T12:40:43.885076Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006000995635986328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_dm__customers_metrics_customer_vip.a3707571d2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_vip\nfrom RAW.RAW_SIMULATION.dm__customers_metrics\nwhere customer_vip is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.886075Z", "completed_at": "2025-05-14T12:40:43.889087Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.890088Z", "completed_at": "2025-05-14T12:40:43.890088Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00501251220703125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_dm__customers_metrics_total_customers_orders.43f1c24fc9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_customers_orders\nfrom RAW.RAW_SIMULATION.dm__customers_metrics\nwhere total_customers_orders is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.891072Z", "completed_at": "2025-05-14T12:40:43.895088Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.895088Z", "completed_at": "2025-05-14T12:40:43.895088Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004015684127807617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.unique_dm__customers_metrics_customer_id.1a1a8b245c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom RAW.RAW_SIMULATION.dm__customers_metrics\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.897077Z", "completed_at": "2025-05-14T12:40:43.899087Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.900089Z", "completed_at": "2025-05-14T12:40:43.900089Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004010677337646484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.best_selling_products_by_category", "compiled": true, "compiled_code": "\n\nWITH products AS (\n\n    SELECT *\n    FROM RAW.RAW_SIMULATION.dm__products_metrics\n),\n\nbest_selling_products_by_category_revenue AS (\n\n    SELECT\n\n        p.product_id,\n        p.product_name,\n        p.product_category,\n        p.total_revenue_usd,\n\n        RANK() OVER (\n            PARTITION BY p.product_category\n            ORDER BY ROUND(p.total_revenue_usd, 2) DESC\n        ) AS rank_products\n\n    FROM products p\n    QUALIFY rank_products <= 5\n),\n\nbest_selling_products_by_category_orders AS (\n\n    SELECT\n\n        p.product_id,\n        p.product_name,\n        p.product_category,\n        p.total_unit_sold,\n\n        RANK() OVER (\n            PARTITION BY p.product_category\n            ORDER BY total_unit_sold DESC\n        ) AS rank_products\n\n    FROM products p\n    QUALIFY rank_products <= 5\n)\n\nSELECT\n\n    product_id,\n    product_name,\n    product_category,\n    ROUND(total_revenue_usd) AS total_revenue_and_orders,\n    rank_products,\n    'REVENUE' AS ranking_type\n\nFROM best_selling_products_by_category_revenue\n\nUNION ALL\n\nSELECT\n\n    product_id,\n    product_name,\n    product_category,\n    total_unit_sold AS total_sales,\n    rank_products,\n    'ORDERS' AS ranking_type\n\nFROM best_selling_products_by_category_orders", "relation_name": "RAW.RAW_SIMULATION.best_selling_products_by_category", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.902072Z", "completed_at": "2025-05-14T12:40:43.905088Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.905088Z", "completed_at": "2025-05-14T12:40:43.905088Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004015684127807617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.product_performance_over_time", "compiled": true, "compiled_code": "\n\nWITH products AS (\n\n    SELECT *\n    FROM RAW.RAW_SIMULATION.dm__products_metrics\n),\n\nsales AS (\n\n    SELECT *\n    FROM RAW.RAW_SIMULATION.fct_sales__finance_metrics_usd\n),\n\nrevenue_and_unit_month AS (\n    SELECT\n        p.product_id,\n        p.product_name,\n        DATE_TRUNC('month', s.sale_date) AS month,\n        SUM(s.quantity_ordered) AS total_unit_per_month,\n        ROUND(SUM(s.total_value)) AS revenue_generated_per_month\n\n    FROM products p\n    LEFT JOIN sales s ON p.product_id = s.product_id\n    GROUP BY p.product_id, p.product_name, month\n\n),\n\nrevenue_and_unit_week AS (\n    SELECT\n        p.product_id,\n        p.product_name,\n        DATE_TRUNC('week', s.sale_date) AS week,\n        SUM(s.quantity_ordered) AS total_unit_per_week,\n        ROUND(SUM(s.total_value)) AS revenue_generated_per_week\n\n    FROM products p\n    LEFT JOIN sales s ON p.product_id = s.product_id\n    GROUP BY p.product_id, p.product_name, week\n\n)\n\nSELECT\n    product_id,\n    product_name,\n    month AS date,\n    total_unit_per_month AS total_unit_sold,\n    revenue_generated_per_month AS total_revenue_generated,\n    'MONTH' AS period_type\nFROM revenue_and_unit_month\n\nUNION ALL\n\nSELECT\n    product_id,\n    product_name,\n    week AS date,\n    total_unit_per_week AS total_unit_sold,\n    revenue_generated_per_week AS total_revenue_generated,\n    'WEEK' AS period_type\nFROM revenue_and_unit_week\n\nORDER BY date, product_id", "relation_name": "RAW.RAW_SIMULATION.product_performance_over_time", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.907090Z", "completed_at": "2025-05-14T12:40:43.909075Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.910097Z", "completed_at": "2025-05-14T12:40:43.910097Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004002571105957031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.sales_by_category_and_period", "compiled": true, "compiled_code": "\n\nWITH sales AS (\n\n    SELECT *\n    FROM RAW.RAW_SIMULATION.fct_sales__finance_metrics_usd\n),\n\nproducts AS (\n\n    SELECT *\n    FROM RAW.RAW_SIMULATION.dm__products_metrics\n),\n\n\nstrategic_analysis as (\n    SELECT\n        p.product_category,\n        DATE_TRUNC('month', s.sale_date) as month,\n        CASE\n            WHEN EXTRACT(MONTH FROM s.sale_date) IN (12,1,2) THEN 'SUMMER'\n            WHEN EXTRACT(MONTH FROM s.sale_date) IN (3,4,5) THEN 'FALL'\n            WHEN EXTRACT(MONTH FROM s.sale_date) IN (6,7,8) THEN 'WINTER'\n            WHEN EXTRACT(MONTH FROM s.sale_date) IN (9,10,11) THEN 'SPRING'\n            ELSE NULL\n        END as station,\n\n        SUM(ROUND(s.total_value)) as total_revenue_by_month,\n        COUNT(s.sale_id) as total_sales_by_month\n\n\n    FROM sales s\n    JOIN products p ON s.product_id = p.product_id\n    GROUP BY p.product_category, DATE_TRUNC('month', s.sale_date), station\n)\n\nSELECT * FROM strategic_analysis", "relation_name": "RAW.RAW_SIMULATION.sales_by_category_and_period", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.911077Z", "completed_at": "2025-05-14T12:40:43.915076Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.915076Z", "completed_at": "2025-05-14T12:40:43.915076Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003998756408691406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.project_currency_conversion.vip_or_non_vip_customer_behavior", "compiled": true, "compiled_code": "\n\n\nWITH customers AS (\n    SELECT *\n    FROM RAW.RAW_SIMULATION.dm__customers_metrics\n),\n\nproducts AS (\n\n    SELECT *\n    FROM RAW.RAW_SIMULATION.dm__products_metrics\n),\n\nsales AS (\n\n    SELECT *\n    FROM RAW.RAW_SIMULATION.fct_sales__finance_metrics_usd\n),\n\nbase AS (\n    SELECT\n        c.customer_id,\n        c.total_spend,\n        c.total_customer_orders,\n        c.customer_vip,\n        p.product_category\n\n    FROM customers c\n    LEFT JOIN sales s ON c.customer_id = s.customer_id\n    LEFT JOIN products p ON s.product_id = p.product_id\n),\n\nmost_purchased_category AS (\n    SELECT\n        customer_vip,\n        product_category,\n        COUNT(*) AS category_purchase\n\n    FROM base\n    GROUP BY customer_vip, product_category\n),\n\nranked_categories AS (\n    SELECT\n        *,\n        RANK() OVER (\n            PARTITION BY customer_vip\n            ORDER BY product_category\n        ) AS rank_categories\n\n    FROM most_purchased_category\n    QUALIFY rank_categories = 1\n),\n\nbehavior_vip_or_non_vip AS (\n    SELECT\n\n        c.customer_vip,\n\n        ROUND(SUM(c.total_spend) / SUM(c.total_customer_orders)) AS average_ticket,\n        ROUND(AVG(c.total_customer_orders)) AS frequency\n\n    FROM customers c\n    GROUP BY c.customer_vip\n)\n\nSELECT\n    b.customer_vip,\n    b.average_ticket,\n    b.frequency,\n    rk.product_category AS most_purchased_category\nFROM behavior_vip_or_non_vip b\nLEFT JOIN ranked_categories rk ON b.customer_vip = rk.customer_vip", "relation_name": "RAW.RAW_SIMULATION.vip_or_non_vip_customer_behavior", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.917077Z", "completed_at": "2025-05-14T12:40:43.921088Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.921088Z", "completed_at": "2025-05-14T12:40:43.921088Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0050084590911865234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_dm__products_metrics_product_id.ae17f5d249", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom RAW.RAW_SIMULATION.dm__products_metrics\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.922793Z", "completed_at": "2025-05-14T12:40:43.926798Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.926798Z", "completed_at": "2025-05-14T12:40:43.926798Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00400543212890625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_dm__products_metrics_total_revenue_usd.45efa52503", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_revenue_usd\nfrom RAW.RAW_SIMULATION.dm__products_metrics\nwhere total_revenue_usd is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.928838Z", "completed_at": "2025-05-14T12:40:43.933812Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.934797Z", "completed_at": "2025-05-14T12:40:43.934797Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006999015808105469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_dm__products_metrics_total_sales_count.ad1ad009b2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_sales_count\nfrom RAW.RAW_SIMULATION.dm__products_metrics\nwhere total_sales_count is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.935914Z", "completed_at": "2025-05-14T12:40:43.939925Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.939925Z", "completed_at": "2025-05-14T12:40:43.939925Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0040111541748046875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.unique_dm__products_metrics_product_id.19f673e7bb", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_id as unique_field,\n    count(*) as n_records\n\nfrom RAW.RAW_SIMULATION.dm__products_metrics\nwhere product_id is not null\ngroup by product_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.941924Z", "completed_at": "2025-05-14T12:40:43.945925Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.945925Z", "completed_at": "2025-05-14T12:40:43.945925Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005000591278076172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_dm__stores_metrics_store_id.2b2f54209a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect store_id\nfrom RAW.RAW_SIMULATION.dm__stores_metrics\nwhere store_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.947925Z", "completed_at": "2025-05-14T12:40:43.950924Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.951924Z", "completed_at": "2025-05-14T12:40:43.951924Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005000591278076172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_dm__stores_metrics_total_revenue_store.a326cf7605", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_revenue_store\nfrom RAW.RAW_SIMULATION.dm__stores_metrics\nwhere total_revenue_store is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.952924Z", "completed_at": "2025-05-14T12:40:43.957943Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.957943Z", "completed_at": "2025-05-14T12:40:43.957943Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005018949508666992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_dm__stores_metrics_total_sales_store.0429e8302d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_sales_store\nfrom RAW.RAW_SIMULATION.dm__stores_metrics\nwhere total_sales_store is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.959930Z", "completed_at": "2025-05-14T12:40:43.963939Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.963939Z", "completed_at": "2025-05-14T12:40:43.963939Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005013942718505859, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.unique_dm__stores_metrics_store_id.be738311d4", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    store_id as unique_field,\n    count(*) as n_records\n\nfrom RAW.RAW_SIMULATION.dm__stores_metrics\nwhere store_id is not null\ngroup by store_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.964947Z", "completed_at": "2025-05-14T12:40:43.968939Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.968939Z", "completed_at": "2025-05-14T12:40:43.968939Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003991842269897461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_geographical_distribution_state.deb2b2e308", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect state\nfrom RAW.RAW_SIMULATION.geographical_distribution\nwhere state is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.970939Z", "completed_at": "2025-05-14T12:40:43.973939Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.974930Z", "completed_at": "2025-05-14T12:40:43.974930Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0050046443939208984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_geographical_distribution_store_city.054f25f91f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect store_city\nfrom RAW.RAW_SIMULATION.geographical_distribution\nwhere store_city is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.976420Z", "completed_at": "2025-05-14T12:40:43.979440Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.980432Z", "completed_at": "2025-05-14T12:40:43.980432Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005502462387084961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_customer_ltv_customer_id.6e2035d30b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom RAW.RAW_SIMULATION.customer_ltv\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.981447Z", "completed_at": "2025-05-14T12:40:43.985425Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.985425Z", "completed_at": "2025-05-14T12:40:43.985425Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00397801399230957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_customer_ltv_customer_ltv.d6e7a461b8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_ltv\nfrom RAW.RAW_SIMULATION.customer_ltv\nwhere customer_ltv is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.987424Z", "completed_at": "2025-05-14T12:40:43.990442Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.990442Z", "completed_at": "2025-05-14T12:40:43.990442Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004016876220703125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.unique_customer_ltv_customer_id.e975ef62fa", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom RAW.RAW_SIMULATION.customer_ltv\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.992774Z", "completed_at": "2025-05-14T12:40:43.996772Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:43.997758Z", "completed_at": "2025-05-14T12:40:43.997758Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0060062408447265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_customer_repeat_rate_repeat_customer_rate_percentage.7ef0ab475e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect repeat_customer_rate_percentage\nfrom RAW.RAW_SIMULATION.customer_repeat_rate\nwhere repeat_customer_rate_percentage is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:43.998795Z", "completed_at": "2025-05-14T12:40:44.049773Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:44.050772Z", "completed_at": "2025-05-14T12:40:44.050772Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.053014278411865234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_most_common_product_bundles_customer_id.d768ac05fb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom RAW.RAW_SIMULATION.most_common_product_bundles\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:44.052758Z", "completed_at": "2025-05-14T12:40:44.057759Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:44.057759Z", "completed_at": "2025-05-14T12:40:44.057759Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0059967041015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_most_common_product_bundles_product_1.f5964f3532", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_1\nfrom RAW.RAW_SIMULATION.most_common_product_bundles\nwhere product_1 is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:44.059775Z", "completed_at": "2025-05-14T12:40:44.062772Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:44.062772Z", "completed_at": "2025-05-14T12:40:44.062772Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003985881805419922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.unique_most_common_product_bundles_customer_id.83c2541cf8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom RAW.RAW_SIMULATION.most_common_product_bundles\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:44.064778Z", "completed_at": "2025-05-14T12:40:44.068764Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:44.069759Z", "completed_at": "2025-05-14T12:40:44.069759Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005999565124511719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.accepted_values_best_selling_products_by_category_ranking_type__REVENUE__ORDERS.eadf94185e", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        ranking_type as value_field,\n        count(*) as n_records\n\n    from RAW.RAW_SIMULATION.best_selling_products_by_category\n    group by ranking_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'REVENUE','ORDERS'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:44.070780Z", "completed_at": "2025-05-14T12:40:44.074774Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:44.075761Z", "completed_at": "2025-05-14T12:40:44.075761Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004981517791748047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_best_selling_products_by_category_product_id.1a8f54d289", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom RAW.RAW_SIMULATION.best_selling_products_by_category\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:44.077773Z", "completed_at": "2025-05-14T12:40:44.080773Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:44.080773Z", "completed_at": "2025-05-14T12:40:44.080773Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003994941711425781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_best_selling_products_by_category_ranking_type.e7d4d0602e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ranking_type\nfrom RAW.RAW_SIMULATION.best_selling_products_by_category\nwhere ranking_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:44.082763Z", "completed_at": "2025-05-14T12:40:44.086773Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:44.087762Z", "completed_at": "2025-05-14T12:40:44.087762Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006001949310302734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.accepted_values_product_performance_over_time_period_type__MONTH__WEEK.4e42cdc613", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        period_type as value_field,\n        count(*) as n_records\n\n    from RAW.RAW_SIMULATION.product_performance_over_time\n    group by period_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'MONTH','WEEK'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:44.088788Z", "completed_at": "2025-05-14T12:40:44.092774Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:44.092774Z", "completed_at": "2025-05-14T12:40:44.092774Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003985404968261719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_product_performance_over_time_date.dde24ce842", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date\nfrom RAW.RAW_SIMULATION.product_performance_over_time\nwhere date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:44.094758Z", "completed_at": "2025-05-14T12:40:44.097774Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:44.097774Z", "completed_at": "2025-05-14T12:40:44.097774Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003990888595581055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_product_performance_over_time_product_id.14f2506498", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom RAW.RAW_SIMULATION.product_performance_over_time\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:44.099773Z", "completed_at": "2025-05-14T12:40:44.103774Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:44.103774Z", "completed_at": "2025-05-14T12:40:44.103774Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005015373229980469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.accepted_values_vip_or_non_vip_customer_behavior_most_purchased_category__Roupas__Eletr_nicos__Brinquedos__Alimentos__Livros.a7270ccc92", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        most_purchased_category as value_field,\n        count(*) as n_records\n\n    from RAW.RAW_SIMULATION.vip_or_non_vip_customer_behavior\n    group by most_purchased_category\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Roupas','Eletr\u00f4nicos','Brinquedos','Alimentos','Livros'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:44.105774Z", "completed_at": "2025-05-14T12:40:44.108773Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:44.109759Z", "completed_at": "2025-05-14T12:40:44.109759Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004975318908691406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.not_null_vip_or_non_vip_customer_behavior_customer_vip.5e4d226e7c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_vip\nfrom RAW.RAW_SIMULATION.vip_or_non_vip_customer_behavior\nwhere customer_vip is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-14T12:40:44.110778Z", "completed_at": "2025-05-14T12:40:44.113773Z"}, {"name": "execute", "started_at": "2025-05-14T12:40:44.114759Z", "completed_at": "2025-05-14T12:40:44.114759Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004999876022338867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.project_currency_conversion.unique_vip_or_non_vip_customer_behavior_customer_vip.0e33b5ead6", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_vip as unique_field,\n    count(*) as n_records\n\nfrom RAW.RAW_SIMULATION.vip_or_non_vip_customer_behavior\nwhere customer_vip is not null\ngroup by customer_vip\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 1.6665544509887695, "args": {"log_level_file": "debug", "project_dir": "C:\\Users\\vinic\\Projetos\\meus_projetos\\project-currency-conversion", "which": "generate", "static": false, "introspect": true, "print": true, "require_explicit_package_overrides_for_builtin_materializations": true, "strict_mode": false, "populate_cache": true, "indirect_selection": "eager", "partial_parse_file_diff": true, "require_yaml_configuration_for_mf_time_spines": false, "warn_error_options": {"include": [], "exclude": []}, "profiles_dir": "C:/Users/vinic/Projetos/meus_projetos/project-currency-conversion", "log_path": "C:\\Users\\vinic\\Projetos\\meus_projetos\\project-currency-conversion\\logs", "source_freshness_run_project_hooks": false, "vars": {}, "quiet": false, "empty_catalog": false, "log_format": "default", "exclude": [], "version_check": true, "require_batched_execution_for_custom_microbatch_strategy": false, "compile": true, "log_format_file": "debug", "use_colors_file": true, "cache_selected_only": false, "send_anonymous_usage_stats": true, "static_parser": true, "use_colors": true, "favor_state": false, "state_modified_compare_vars": false, "select": [], "log_level": "info", "write_json": true, "log_file_max_bytes": 10485760, "defer": false, "require_resource_names_without_spaces": false, "state_modified_compare_more_unrendered_values": false, "require_nested_cumulative_type_params": false, "macro_debugging": false, "show_resource_report": false, "printer_width": 80, "invocation_command": "dbt docs generate", "partial_parse": true, "skip_nodes_if_on_run_start_fails": false}}