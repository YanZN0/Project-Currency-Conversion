-- back compat for old kwarg name
  
  begin;
    
        
            
	    
	    
            
        
    

    

    merge into RAW.RAW_SIMULATION.int__stores_metrics as DBT_INTERNAL_DEST
        using RAW.RAW_SIMULATION.int__stores_metrics__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.store_id = DBT_INTERNAL_DEST.store_id))

    
    when matched then update set
        "STORE_ID" = DBT_INTERNAL_SOURCE."STORE_ID","STORE_NAME" = DBT_INTERNAL_SOURCE."STORE_NAME","STORE_CITY" = DBT_INTERNAL_SOURCE."STORE_CITY","STATE" = DBT_INTERNAL_SOURCE."STATE","TOTAL_SALES_STORE" = DBT_INTERNAL_SOURCE."TOTAL_SALES_STORE","TOTAL_REVENUE_STORE_USD" = DBT_INTERNAL_SOURCE."TOTAL_REVENUE_STORE_USD","AVERAGE_SALE_VALUE_USD" = DBT_INTERNAL_SOURCE."AVERAGE_SALE_VALUE_USD","FIRST_SALE" = DBT_INTERNAL_SOURCE."FIRST_SALE","LAST_SALE" = DBT_INTERNAL_SOURCE."LAST_SALE"
    

    when not matched then insert
        ("STORE_ID", "STORE_NAME", "STORE_CITY", "STATE", "TOTAL_SALES_STORE", "TOTAL_REVENUE_STORE_USD", "AVERAGE_SALE_VALUE_USD", "FIRST_SALE", "LAST_SALE")
    values
        ("STORE_ID", "STORE_NAME", "STORE_CITY", "STATE", "TOTAL_SALES_STORE", "TOTAL_REVENUE_STORE_USD", "AVERAGE_SALE_VALUE_USD", "FIRST_SALE", "LAST_SALE")

;
    commit;