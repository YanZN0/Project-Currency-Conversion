-- back compat for old kwarg name
  
  begin;
    
        
            
	    
	    
            
        
    

    

    merge into RAW.RAW_SIMULATION.int__sales_with_exchange_rates as DBT_INTERNAL_DEST
        using RAW.RAW_SIMULATION.int__sales_with_exchange_rates__dbt_tmp as DBT_INTERNAL_SOURCE
        on ((DBT_INTERNAL_SOURCE.sale_id = DBT_INTERNAL_DEST.sale_id))

    
    when matched then update set
        "SALE_ID" = DBT_INTERNAL_SOURCE."SALE_ID","SALE_DATE" = DBT_INTERNAL_SOURCE."SALE_DATE","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","STORE_ID" = DBT_INTERNAL_SOURCE."STORE_ID","PRODUCT_UNIT_PRICE" = DBT_INTERNAL_SOURCE."PRODUCT_UNIT_PRICE","QUANTITY_ORDERED" = DBT_INTERNAL_SOURCE."QUANTITY_ORDERED","CURRENCY" = DBT_INTERNAL_SOURCE."CURRENCY","ORIGINAL_TOTAL_VALUE" = DBT_INTERNAL_SOURCE."ORIGINAL_TOTAL_VALUE","TOTAL_VALUE_USD" = DBT_INTERNAL_SOURCE."TOTAL_VALUE_USD","CONVERSION_DATE" = DBT_INTERNAL_SOURCE."CONVERSION_DATE"
    

    when not matched then insert
        ("SALE_ID", "SALE_DATE", "CUSTOMER_ID", "PRODUCT_ID", "STORE_ID", "PRODUCT_UNIT_PRICE", "QUANTITY_ORDERED", "CURRENCY", "ORIGINAL_TOTAL_VALUE", "TOTAL_VALUE_USD", "CONVERSION_DATE")
    values
        ("SALE_ID", "SALE_DATE", "CUSTOMER_ID", "PRODUCT_ID", "STORE_ID", "PRODUCT_UNIT_PRICE", "QUANTITY_ORDERED", "CURRENCY", "ORIGINAL_TOTAL_VALUE", "TOTAL_VALUE_USD", "CONVERSION_DATE")

;
    commit;